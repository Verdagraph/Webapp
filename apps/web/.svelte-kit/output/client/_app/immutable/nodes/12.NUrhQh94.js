var dr=Object.defineProperty;var Mt=r=>{throw TypeError(r)};var cr=(r,e,t)=>e in r?dr(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var _t=(r,e,t)=>cr(r,typeof e!="symbol"?e+"":e,t),Ft=(r,e,t)=>e.has(r)||Mt("Cannot "+t);var P=(r,e,t)=>(Ft(r,e,"read from private field"),t?t.call(r):e.get(r)),q=(r,e,t)=>e.has(r)?Mt("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(r):e.set(r,t),we=(r,e,t,n)=>(Ft(r,e,"write to private field"),n?n.call(r,t):e.set(r,t),t);import{A as xt,w as W,t as it}from"../chunks/CpB06Reo.js";import{g as ur}from"../chunks/b4YLuXSw.js";import{a as fr,b as gr,c as vr,w as mr,d as hr}from"../chunks/Da0nG2TK.js";import{t as R,a as c,c as N,b as pe}from"../chunks/Boh5s-Fb.js";import{p as U,aT as tt,c as k,r as T,s as I,t as ce,a as Y,f as x,d as Me,g as s,b as ve,a3 as H,U as pr,u as Se,n as wt,Z as Qt,h as be,aR as br,e as le,a2 as yr}from"../chunks/BwwL9Z8J.js";import{i as $,p as me,r as It,b as xr,c as _r,a as We}from"../chunks/BhVVFR9O.js";import{K as Pe,r as De,d as Be,F as Cr,c as Pr,C as wr,U as Ir,G as kr,g as rt,t as lt}from"../chunks/D8EoPIJC.js";import{f as Tr,S as Sr,g as Lr,w as Er,n as Ar,h as Rr,T as Dr,P as Hr,R as Nr,N as zr}from"../chunks/BDR0CBNG.js";import{c as y}from"../chunks/xbTnOFg-.js";import{u as Pt}from"../chunks/BkmEaUt_.js";import{a as et,e as Dt,i as qt}from"../chunks/kQuJ39Np.js";import{o as Wr,a as Gt}from"../chunks/B3yRNm_7.js";import{g as Bt,h as $r,a as Zt,l as Or,p as jr,b as Mr,c as Fr}from"../chunks/CY1JKKA3.js";import{e as Ue,f as Jt,h as At}from"../chunks/CzawOZ8l.js";import{c as Xe}from"../chunks/Wlm8fm8j.js";import{s as ze}from"../chunks/CxR0UCY4.js";import{e as Br,s as Fe,a as Le,c as Ct,d as Ut}from"../chunks/C-TP-Znv.js";import{e as Yt,i as Ie,D as Xt,T as Ur,j as Yr,k as Xr,l as Vr,m as Kr,g as Qr,P as Lt,f as Vt,h as qr,R as Gr}from"../chunks/CMyw0d79.js";import{b as Zr}from"../chunks/BM2gA-Nh.js";import{s as Ne}from"../chunks/Dzkt4xrc.js";import{I as se}from"../chunks/C8rKVFp6.js";import{B as ge}from"../chunks/BJEHGdzF.js";import{a as Ht,i as Nt,e as zt,f as Jr,u as Wt,b as Ae,m as $t}from"../chunks/YX1G5wxf.js";import{T as ke,R as Te}from"../chunks/Cui_Qo2p.js";import{p as en}from"../chunks/DMeJYrCE.js";import{f as tn}from"../chunks/CAZ9iERp.js";import{I as er}from"../chunks/CpHryQhq.js";import{T as rn}from"../chunks/tGfV_l-0.js";import{S as nn}from"../chunks/DwM7tovx.js";import{B as on}from"../chunks/g3mjCaQ4.js";import{S as an,a as sn,G as ln,b as dn,R as cn}from"../chunks/CvcK00CF.js";var un=R('<div class="relative h-full w-full"><div class="absolute left-[0.5px] top-0 h-full w-full"><!></div> <div class="pointer-events-none absolute left-[0.5px] top-0 z-10 h-full w-full"><!></div></div>');function fn(r,e){U(e,!0);const t=tt(e.canvasId);let n;Wr(()=>{t.initialize();const d=new ResizeObserver(t.container.onResize);return d.observe(n),()=>{d.unobserve(n),d.disconnect()}});var a=un(),l=k(a),o=k(l);{var i=d=>{var f=N(),p=x(f);ze(p,()=>e.children),c(d,f)};$(o,d=>{t.container.initialized&&d(i)})}T(l),Zr(l,d=>n=d,()=>n);var m=I(l,2),v=k(m);ze(v,()=>e.overlay),T(m),T(a),ce(()=>Br(l,"id",e.canvasId)),Yt(a,"clientWidth",d=>t.container.width=d),Yt(a,"clientHeight",d=>t.container.height=d),c(r,a),Y()}function gn(r,e){U(e,!0),tt(e.canvasId).gridManager.initialize(),Y()}const vn="data-collapsible-root",mn="data-collapsible-content",hn="data-collapsible-trigger";var Ve,dt,ct,ut,ft;class pn{constructor(e){q(this,Ve);q(this,dt);_t(this,"open");_t(this,"disabled");q(this,ct,Me(null));q(this,ut,Me(void 0));q(this,ft,H(()=>({id:P(this,Ve).current,"data-state":zt(this.open.current),"data-disabled":Nt(this.disabled.current),[vn]:""})));this.open=e.open,this.disabled=e.disabled,we(this,Ve,e.id),we(this,dt,e.ref),this.toggleOpen=this.toggleOpen.bind(this),Ht({id:P(this,Ve),ref:P(this,dt)})}get contentNode(){return s(P(this,ct))}set contentNode(e){ve(P(this,ct),e,!0)}get contentId(){return s(P(this,ut))}set contentId(e){ve(P(this,ut),e,!0)}toggleOpen(){this.open.current=!this.open.current}get props(){return s(P(this,ft))}set props(e){ve(P(this,ft),e)}}Ve=new WeakMap,dt=new WeakMap,ct=new WeakMap,ut=new WeakMap,ft=new WeakMap;var Ke,Oe,Qe,qe,Ge,Ze,gt,vt,mt,ht;class bn{constructor(e,t){q(this,Ke);q(this,Oe);_t(this,"root");q(this,Qe);q(this,qe,Me(!1));q(this,Ge,Me(0));q(this,Ze,Me(0));q(this,gt);q(this,vt,H(()=>P(this,gt).current||this.root.open.current));q(this,mt,H(()=>({open:this.root.open.current})));q(this,ht,H(()=>({id:P(this,Ke).current,style:{"--bits-collapsible-content-height":s(P(this,Ze))?`${s(P(this,Ze))}px`:void 0,"--bits-collapsible-content-width":s(P(this,Ge))?`${s(P(this,Ge))}px`:void 0},"data-state":zt(this.root.open.current),"data-disabled":Nt(this.root.disabled.current),[mn]:""})));this.root=t,ve(P(this,qe),t.open.current,!0),we(this,gt,e.forceMount),we(this,Ke,e.id),we(this,Oe,e.ref),Ht({id:P(this,Ke),ref:P(this,Oe),deps:()=>this.present,onRefChange:n=>{this.root.contentNode=n,this.root.contentId=n==null?void 0:n.id}}),pr(()=>{const n=requestAnimationFrame(()=>{ve(P(this,qe),!1)});return()=>{cancelAnimationFrame(n)}}),Se(()=>{this.present;const n=P(this,Oe).current;n&&Er(()=>{if(!P(this,Oe).current)return;we(this,Qe,P(this,Qe)||{transitionDuration:n.style.transitionDuration,animationName:n.style.animationName}),n.style.transitionDuration="0s",n.style.animationName="none";const a=n.getBoundingClientRect();if(ve(P(this,Ze),a.height,!0),ve(P(this,Ge),a.width,!0),!s(P(this,qe))){const{animationName:l,transitionDuration:o}=P(this,Qe);n.style.transitionDuration=o,n.style.animationName=l}})})}get present(){return s(P(this,vt))}set present(e){ve(P(this,vt),e)}get snippetProps(){return s(P(this,mt))}set snippetProps(e){ve(P(this,mt),e)}get props(){return s(P(this,ht))}set props(e){ve(P(this,ht),e)}}Ke=new WeakMap,Oe=new WeakMap,Qe=new WeakMap,qe=new WeakMap,Ge=new WeakMap,Ze=new WeakMap,gt=new WeakMap,vt=new WeakMap,mt=new WeakMap,ht=new WeakMap;var Ee,pt,Je,bt,je,yt;class yn{constructor(e,t){q(this,Ee);q(this,pt);q(this,Je);q(this,bt);q(this,je,H(()=>P(this,bt).current||P(this,Ee).disabled.current));q(this,yt,H(()=>({id:P(this,Je).current,type:"button",disabled:s(P(this,je)),"aria-controls":P(this,Ee).contentId,"aria-expanded":Jr(P(this,Ee).open.current),"data-state":zt(P(this,Ee).open.current),"data-disabled":Nt(s(P(this,je))),[hn]:"",onclick:this.onclick,onkeydown:this.onkeydown})));we(this,Ee,t),we(this,Je,e.id),we(this,pt,e.ref),we(this,bt,e.disabled),this.onclick=this.onclick.bind(this),this.onkeydown=this.onkeydown.bind(this),Ht({id:P(this,Je),ref:P(this,pt)})}onclick(e){if(!s(P(this,je))){if(e.button!==0)return e.preventDefault();P(this,Ee).toggleOpen()}}onkeydown(e){s(P(this,je))||(e.key===Sr||e.key===Lr)&&(e.preventDefault(),P(this,Ee).toggleOpen())}get props(){return s(P(this,yt))}set props(e){ve(P(this,yt),e)}}Ee=new WeakMap,pt=new WeakMap,Je=new WeakMap,bt=new WeakMap,je=new WeakMap,yt=new WeakMap;const[xn,tr]=Tr("Collapsible.Root");function _n(r){return xn(new pn(r))}function Cn(r){const e=tr();return new yn(r,e)}function Pn(r){const e=tr();return new bn(r,e)}var wn=R("<div><!></div>");function In(r,e){U(e,!0);let t=me(e,"id",19,Wt),n=me(e,"ref",15,null),a=me(e,"open",15,!1),l=me(e,"disabled",3,!1),o=me(e,"controlledOpen",3,!1),i=me(e,"onOpenChange",3,Ar),m=It(e,["$$slots","$$events","$$legacy","children","child","id","ref","open","disabled","controlledOpen","onOpenChange"]);const v=_n({open:Ae.with(()=>a(),u=>{o()||a(u),i()(u)}),disabled:Ae.with(()=>l()),id:Ae.with(()=>t()),ref:Ae.with(()=>n(),u=>n(u))}),d=H(()=>$t(m,v.props));var f=N(),p=x(f);{var C=u=>{var b=N(),w=x(b);ze(w,()=>e.child,()=>({props:s(d)})),c(u,b)},h=u=>{var b=wn();let w;var g=k(b);ze(g,()=>e.children??wt),T(b),ce(()=>w=Fe(b,w,{...s(d)})),c(u,b)};$(p,u=>{e.child?u(C):u(h,!1)})}c(r,f),Y()}var kn=R("<div><!></div>");function Tn(r,e){U(e,!0);let t=me(e,"ref",15,null),n=me(e,"forceMount",3,!1),a=me(e,"id",19,Wt),l=It(e,["$$slots","$$events","$$legacy","child","ref","forceMount","children","id"]);const o=Pn({id:Ae.with(()=>a()),forceMount:Ae.with(()=>n()),ref:Ae.with(()=>t(),i=>t(i))});Rr(r,{forceMount:!0,get present(){return o.present},get id(){return a()},presence:(m,v)=>{let d=()=>v==null?void 0:v().present;var f=N();const p=H(()=>$t(l,o.props,{hidden:n()?void 0:!d().current}));var C=x(f);{var h=b=>{var w=N(),g=x(w),_=Qt(()=>({...o.snippetProps,props:s(p)}));ze(g,()=>e.child,()=>s(_)),c(b,w)},u=b=>{var w=kn();let g;var _=k(w);ze(_,()=>e.children??wt),T(w),ce(()=>g=Fe(w,g,{...s(p)})),c(b,w)};$(C,b=>{e.child?b(h):b(u,!1)})}c(m,f)},$$slots:{presence:!0}}),Y()}var Sn=R("<button><!></button>");function Ln(r,e){U(e,!0);let t=me(e,"ref",15,null),n=me(e,"id",19,Wt),a=me(e,"disabled",3,!1),l=It(e,["$$slots","$$events","$$legacy","children","child","ref","id","disabled"]);const o=Cn({id:Ae.with(()=>n()),ref:Ae.with(()=>t(),p=>t(p)),disabled:Ae.with(()=>a())}),i=H(()=>$t(l,o.props));var m=N(),v=x(m);{var d=p=>{var C=N(),h=x(C);ze(h,()=>e.child,()=>({props:s(i)})),c(p,C)},f=p=>{var C=Sn();let h;var u=k(C);ze(u,()=>e.children??wt),T(C),ce(()=>h=Fe(C,h,{...s(i)})),c(p,C)};$(v,p=>{e.child?p(d):p(f,!1)})}c(r,m),Y()}const En=In,An=Ln,Rn=Tn;var Dn=R("<!> <!>",1),Hn=R('<span class="bg-neutral-1 text-neutral-11 border-neutral-6 flex h-6 w-auto items-center justify-center border-b border-t px-1 py-0.5 text-sm"> </span>'),Nn=R("<!> <!>",1),zn=R("<!> <!>",1),Wn=R("<!> <!>",1),$n=R("<!> <!>",1),On=R("<!> <!>",1),jn=R("<!> <!>",1),Mn=R("<!> <!>",1),Fn=R("<!> <!>",1),Bn=R("<!> <!>",1),Un=R('<div><div class="flex items-center"><!> <!> <!></div> <div><div><!></div> <div><!></div> <div><!></div> <div><!></div></div> <div><!></div> <div><!></div> <div><!></div></div>'),Yn=R("<!> <!> <!>",1),Xn=R("<div><!></div>");function Vn(r,e){U(e,!0);let t=tt(e.canvasId);const n=400;let a=H(()=>t.container.width<n?"vertical":"horizontal"),l=H(()=>{switch(t.transform.config.buttonsPosition){case"bl":return"justify-start items-end";case"br":return"justify-end items-end";case"tl":return"justify-start items-start";case"tr":return"justify-end items-start"}}),o=H(()=>{switch(s(a)){case"horizontal":switch(t.transform.config.buttonsPosition){case"bl":return"flex-row";case"br":return"flex-row-reverse";case"tl":return"flex-row";case"tr":return"flex-row-reverse"}break;case"vertical":switch(t.transform.config.buttonsPosition){case"bl":return"flex-col-reverse";case"br":return"flex-col-reverse";case"tl":return"flex-col";case"tr":return"flex-col"}break}}),i=H(()=>{switch(s(a)){case"horizontal":switch(t.transform.config.buttonsPosition){case"bl":return"items-end";case"br":return"items-end";case"tl":return"items-start";case"tr":return"items-start"}break;case"vertical":switch(t.transform.config.buttonsPosition){case"bl":return"items-start";case"br":return"items-end";case"tl":return"items-start";case"tr":return"items-end"}break}}),m=H(()=>{switch(s(a)){case"horizontal":switch(t.transform.config.buttonsPosition){case"bl":return t.transform.config.buttonsExpanded?"rotate-180":"rotate-10";case"br":return t.transform.config.buttonsExpanded?"rotate-0":"rotate-180";case"tl":return t.transform.config.buttonsExpanded?"rotate-180":"rotate-0";case"tr":return t.transform.config.buttonsExpanded?"rotate-0":"rotate-180"}break;case"vertical":switch(t.transform.config.buttonsPosition){case"bl":return t.transform.config.buttonsExpanded?"-rotate-90":"rotate-90";case"br":return t.transform.config.buttonsExpanded?"-rotate-90":"rotate-90";case"tl":return t.transform.config.buttonsExpanded?"rotate-90":"-rotate-90";case"tr":return t.transform.config.buttonsExpanded?"rotate-90":"-rotate-90"}break}});var v=Xn(),d=k(v);y(d,()=>Te,(f,p)=>{p(f,{delayDuration:800,children:(C,h)=>{var u=N(),b=x(u);y(b,()=>En,(w,g)=>{g(w,{get class(){return`z-50 flex ${s(o)??""} ${s(i)??""} justify-start gap-2`},get open(){return t.transform.config.buttonsExpanded},set open(_){t.transform.config.buttonsExpanded=_},children:(_,K)=>{var X=Yn(),ae=x(X);y(ae,()=>ke,(O,V)=>{V(O,{class:"order-last",children:(Z,F)=>{var B=N(),G=x(B);y(G,()=>An,(ue,xe)=>{xe(ue,{children:(he,D)=>{ge(he,{variant:"outline",size:"xsm",class:"hover:bg-secondary-5 bg-neutral-1 hover:text-secondary-12 pointer-events-auto flex items-center justify-center",children:(z,fe)=>{se(z,{icon:"material-symbols:double-arrow",width:"3rem",get class(){return`${s(m)??""} text-neutral-11 transition-transform`}})},$$slots:{default:!0}})},$$slots:{default:!0}})}),c(Z,B)},$$slots:{default:!0}})});var ie=I(ae,2);y(ie,()=>Ie,(O,V)=>{V(O,{children:(Z,F)=>{be();var B=pe("Toggle Layout Controls");c(Z,B)},$$slots:{default:!0}})});var ye=I(ie,2);y(ye,()=>Rn,(O,V)=>{V(O,{children:(Z,F)=>{var B=Un(),G=k(B),ue=k(G);y(ue,()=>Te,(ee,te)=>{te(ee,{children:(re,Re)=>{var j=Dn(),M=x(j);y(M,()=>ke,(L,E)=>{E(L,{children:(A,oe)=>{ge(A,{onclick:()=>{t.transform.addScale(-.1)},variant:"outline",size:"xsm",class:"hover:bg-secondary-5 bg-neutral-1 hover:text-secondary-12 border-r-neutral-4 pointer-events-auto flex items-center justify-center rounded-r-none",children:(S,Ce)=>{se(S,{icon:"material-symbols:zoom-out",width:"3rem",class:"text-neutral-11"})},$$slots:{default:!0}})},$$slots:{default:!0}})});var ne=I(M,2);y(ne,()=>Ie,(L,E)=>{E(L,{children:(A,oe)=>{be();var S=pe("Zoom out");c(A,S)},$$slots:{default:!0}})}),c(re,j)},$$slots:{default:!0}})});var xe=I(ue,2);y(xe,()=>Te,(ee,te)=>{te(ee,{children:(re,Re)=>{var j=Nn(),M=x(j);y(M,()=>ke,(L,E)=>{E(L,{children:(A,oe)=>{var S=Hn(),Ce=k(S);T(S),ce(St=>Ne(Ce,`${St??""}
									%`),[()=>Math.trunc(t.transform.scaleFactor.x*100)]),c(A,S)},$$slots:{default:!0}})});var ne=I(M,2);y(ne,()=>Ie,(L,E)=>{E(L,{children:(A,oe)=>{be();var S=pe("Current zoom percentage");c(A,S)},$$slots:{default:!0}})}),c(re,j)},$$slots:{default:!0}})});var he=I(xe,2);y(he,()=>Te,(ee,te)=>{te(ee,{children:(re,Re)=>{var j=zn(),M=x(j);y(M,()=>ke,(L,E)=>{E(L,{children:(A,oe)=>{ge(A,{onclick:()=>{t.transform.addScale(.1)},variant:"outline",size:"xsm",class:"hover:bg-secondary-5 bg-neutral-1 hover:text-secondary-12 border-l-neutral-4 pointer-events-auto flex items-center justify-center rounded-l-none",children:(S,Ce)=>{se(S,{icon:"material-symbols:zoom-in",width:"3rem",class:"text-neutral-11"})},$$slots:{default:!0}})},$$slots:{default:!0}})});var ne=I(M,2);y(ne,()=>Ie,(L,E)=>{E(L,{children:(A,oe)=>{be();var S=pe("Zoom in");c(A,S)},$$slots:{default:!0}})}),c(re,j)},$$slots:{default:!0}})}),T(G);var D=I(G,2),z=k(D),fe=k(z);y(fe,()=>Te,(ee,te)=>{te(ee,{children:(re,Re)=>{var j=Wn(),M=x(j);y(M,()=>ke,(L,E)=>{E(L,{children:(A,oe)=>{ge(A,{onclick:()=>{t.transform.translate({x:120,y:0})},variant:"outline",size:"xsm",class:"hover:bg-secondary-5 bg-neutral-1 hover:text-secondary-12 pointer-events-auto flex items-center justify-center",children:(S,Ce)=>{se(S,{icon:"material-symbols:arrow-back-2",width:"3rem",class:"text-neutral-11"})},$$slots:{default:!0}})},$$slots:{default:!0}})});var ne=I(M,2);y(ne,()=>Ie,(L,E)=>{E(L,{children:(A,oe)=>{be();var S=pe("Move Left");c(A,S)},$$slots:{default:!0}})}),c(re,j)},$$slots:{default:!0}})}),T(z);var Q=I(z,2),J=k(Q);y(J,()=>Te,(ee,te)=>{te(ee,{children:(re,Re)=>{var j=$n(),M=x(j);y(M,()=>ke,(L,E)=>{E(L,{children:(A,oe)=>{ge(A,{onclick:()=>{t.transform.translate({x:0,y:120})},variant:"outline",size:"xsm",class:"hover:bg-secondary-5 bg-neutral-1 hover:text-secondary-12 pointer-events-auto flex items-center justify-center",children:(S,Ce)=>{se(S,{icon:"material-symbols:arrow-back-2",width:"3rem",class:"text-neutral-11 rotate-90"})},$$slots:{default:!0}})},$$slots:{default:!0}})});var ne=I(M,2);y(ne,()=>Ie,(L,E)=>{E(L,{children:(A,oe)=>{be();var S=pe("Move up");c(A,S)},$$slots:{default:!0}})}),c(re,j)},$$slots:{default:!0}})}),T(Q);var _e=I(Q,2),kt=k(_e);y(kt,()=>Te,(ee,te)=>{te(ee,{children:(re,Re)=>{var j=On(),M=x(j);y(M,()=>ke,(L,E)=>{E(L,{children:(A,oe)=>{ge(A,{onclick:()=>{t.transform.translate({x:-120,y:0})},variant:"outline",size:"xsm",class:"hover:bg-secondary-5 bg-neutral-1 hover:text-secondary-12 pointer-events-auto flex items-center justify-center",children:(S,Ce)=>{se(S,{icon:"material-symbols:arrow-back-2",width:"3rem",class:"text-neutral-11 rotate-180"})},$$slots:{default:!0}})},$$slots:{default:!0}})});var ne=I(M,2);y(ne,()=>Ie,(L,E)=>{E(L,{children:(A,oe)=>{be();var S=pe("Move right");c(A,S)},$$slots:{default:!0}})}),c(re,j)},$$slots:{default:!0}})}),T(_e);var ot=I(_e,2),Tt=k(ot);y(Tt,()=>Te,(ee,te)=>{te(ee,{children:(re,Re)=>{var j=jn(),M=x(j);y(M,()=>ke,(L,E)=>{E(L,{children:(A,oe)=>{ge(A,{onclick:()=>{t.transform.translate({x:0,y:-120})},variant:"outline",size:"xsm",class:"hover:bg-secondary-5 bg-neutral-1 hover:text-secondary-12 pointer-events-auto flex items-center justify-center",children:(S,Ce)=>{se(S,{icon:"material-symbols:arrow-back-2",width:"3rem",class:"text-neutral-11 -rotate-90"})},$$slots:{default:!0}})},$$slots:{default:!0}})});var ne=I(M,2);y(ne,()=>Ie,(L,E)=>{E(L,{children:(A,oe)=>{be();var S=pe("Move down");c(A,S)},$$slots:{default:!0}})}),c(re,j)},$$slots:{default:!0}})}),T(ot),T(D);var at=I(D,2),$e=k(at);y($e,()=>Te,(ee,te)=>{te(ee,{children:(re,Re)=>{var j=Mn(),M=x(j);y(M,()=>ke,(L,E)=>{E(L,{children:(A,oe)=>{ge(A,{get onclick(){return t.transform.reset},variant:"outline",size:"xsm",class:"hover:bg-secondary-5 bg-neutral-1 hover:text-secondary-12 pointer-events-auto flex items-center justify-center",children:(S,Ce)=>{se(S,{icon:"material-symbols:home",width:"3rem",class:"text-neutral-11"})},$$slots:{default:!0}})},$$slots:{default:!0}})});var ne=I(M,2);y(ne,()=>Ie,(L,E)=>{E(L,{children:(A,oe)=>{be();var S=pe("Reset layout position");c(A,S)},$$slots:{default:!0}})}),c(re,j)},$$slots:{default:!0}})}),T(at);var st=I(at,2),ir=k(st);y(ir,()=>Te,(ee,te)=>{te(ee,{children:(re,Re)=>{var j=Fn(),M=x(j);y(M,()=>ke,(L,E)=>{E(L,{children:(A,oe)=>{const S=H(()=>t.gridManager.config.snapToGrid?"bg-secondary-5 border-secondary-6 hover:bg-neutral-3 hover:border-neutral-8":"bg-neutral-1 hover:bg-secondary-5");ge(A,{onclick:()=>{t.gridManager.config.snapToGrid=!t.gridManager.config.snapToGrid},variant:"outline",size:"xsm",get class(){return`${s(S)??""} hover:text-secondary-12 pointer-events-auto flex rotate-180 items-center justify-center transition-colors`},children:(Ce,St)=>{se(Ce,{icon:"iconoir:magnet-solid",width:"3rem",class:"text-neutral-11"})},$$slots:{default:!0}})},$$slots:{default:!0}})});var ne=I(M,2);y(ne,()=>Ie,(L,E)=>{E(L,{children:(A,oe)=>{be();var S=pe("Toggle snap to grid");c(A,S)},$$slots:{default:!0}})}),c(re,j)},$$slots:{default:!0}})}),T(st);var jt=I(st,2),lr=k(jt);y(lr,()=>Te,(ee,te)=>{te(ee,{children:(re,Re)=>{var j=Bn(),M=x(j);y(M,()=>ke,(L,E)=>{E(L,{children:(A,oe)=>{const S=H(()=>t.gridManager.config.rightAngleConstraint?"bg-secondary-5 border-secondary-6 hover:bg-neutral-3 hover:border-neutral-8":"bg-neutral-1 hover:bg-secondary-5");ge(A,{onclick:()=>{t.gridManager.config.rightAngleConstraint=!t.gridManager.config.rightAngleConstraint},variant:"outline",size:"xsm",get class(){return`${s(S)??""} hover:text-secondary-12 pointer-events-auto flex items-center justify-center transition-colors`},children:(Ce,St)=>{se(Ce,{icon:"mdi:parallel",width:"3rem",class:"text-neutral-11"})},$$slots:{default:!0}})},$$slots:{default:!0}})});var ne=I(M,2);y(ne,()=>Ie,(L,E)=>{E(L,{children:(A,oe)=>{be();var S=pe("Toggle right angle constraint");c(A,S)},$$slots:{default:!0}})}),c(re,j)},$$slots:{default:!0}})}),T(jt),T(B),ce(()=>{Le(B,1,`flex ${s(o)??""} ${s(i)??""} gap-2`),Le(D,1,`grid gap-1 ${s(a)==="horizontal"?"grid-cols-3 grid-rows-2":"grid-cols-2 grid-rows-3"}`),Le(z,1,Ct(s(a)==="horizontal"?"order-1 row-span-2 self-center":"order-2")),Le(Q,1,Ct(s(a)==="horizontal"?"order-2":"order-1 col-span-2 justify-self-center")),Le(_e,1,Ct(s(a)==="horizontal"?"order-3 row-span-2 self-center":"order-3")),Le(ot,1,Ct(s(a)==="horizontal"?"order-4":"order-4 col-span-2 justify-self-center"))}),c(Z,B)},$$slots:{default:!0}})}),c(_,X)},$$slots:{default:!0}})}),c(C,u)},$$slots:{default:!0}})}),T(v),ce(()=>Le(v,1,`flex h-full w-full p-2 ${s(l)??""}`)),c(r,v),Y()}function Kn(r,e){const t=e.safeParse(r);if(!t.success)return t.error.issues.map(n=>n.message)}function Qn(r){switch(r.type){case"RECTANGLE":{const e=r.rectangleLength/2,t=r.rectangleWidth/2;return[{x:-e,y:t},{x:0,y:t},{x:e,y:t},{x:e,y:0},{x:e,y:-t},{x:0,y:-t},{x:-e,y:-t},{x:-e,y:0}]}case"POLYGON":return[{x:0,y:r.polygonRadius}];case"ELLIPSE":{const e=r.ellipseLength/2,t=r.ellipseWidth/2;return[{x:0,y:t},{x:e,y:0},{x:0,y:-t},{x:-e,y:0}]}case"LINES":return r.linesCoordinates.map(e=>({x:e.x,y:e.y}))}}function qn(r,e){U(e,!0);const t=2,n=tt(e.canvasId);let a=new Pe.Group;e.geometryGroup.add(a),a.moveToTop();let l=[],o=e.geometry.type,i=0;function m(v){const d={};switch(e.geometry.type){case"RECTANGLE":{if(v%2===0){const f=Math.abs(l[v].x())*2,p=Math.abs(l[v].y())*2;d.rectangleLength=De(n.transform.modelDistance(f),t),d.rectangleWidth=De(n.transform.modelDistance(p),t)}else if(v===1||v===5){l[v].x(0);const f=Math.abs(l[v].y())*2;d.rectangleWidth=De(n.transform.modelDistance(f),t)}else{l[v].y(0);const f=Math.abs(l[v].x())*2;d.rectangleLength=De(n.transform.modelDistance(f),t)}break}case"POLYGON":{l[v].x(0);const f=Math.abs(l[v].y());d.polygonRadius=De(n.transform.modelDistance(f),t);break}case"ELLIPSE":{if(v%2===0){l[v].x(0);const f=Math.abs(l[v].y())*2;d.ellipseWidth=De(n.transform.modelDistance(f),t)}else{l[v].y(0);const f=Math.abs(l[v].x())*2;d.ellipseLength=De(n.transform.modelDistance(f),t)}break}case"LINES":{d.linesCoordinates=l.map(f=>({x:De(n.transform.modelXPos(f.x()),t),y:De(n.transform.modelYPos(f.y()),t)}));break}}return d}Se(()=>{const v=Qn(e.geometry);i===0||o!=e.geometry.type||i!=v.length?(l=[],a.destroyChildren(),v.forEach((d,f)=>{const p=new Pe.Circle({radius:6,strokeWidth:3,x:n.transform.canvasXPos(d.x),y:n.transform.canvasYPos(d.y),draggable:!0,stroke:e.strokeColor,fill:e.fillColor});p.on("mouseover",C=>{document.body.style.cursor="grab",C.cancelBubble=!0}),p.on("mouseout",C=>{document.body.style.cursor="default",C.cancelBubble=!0}),p.on("dragmove",C=>{e.onTransform&&e.onTransform(m(f),!1),C.cancelBubble=!0}),p.on("dragend",C=>{e.onTransform&&e.onTransform(m(f),!0),C.cancelBubble=!0}),l.push(p),a.add(p)})):v.forEach((d,f)=>{if(l[f])l[f].x(n.transform.canvasXPos(d.x)),l[f].y(n.transform.canvasYPos(d.y));else throw new xt("Geometry resize points caught in an invalid state.")}),a.moveToTop(),o=e.geometry.type,i=v.length}),Se(()=>{l.forEach(v=>{v.stroke(e.strokeColor),v.fill(e.fillColor)})}),Gt(()=>{a.destroy()}),Y()}function Gn(r,e,t=!1,n,a){const l={x:r.transform.canvasXPos(0),y:r.transform.canvasYPos(0),...n};switch(e.type){case"RECTANGLE":return new Pe.Rect({width:r.transform.canvasDistance(e.rectangleLength),height:r.transform.canvasDistance(e.rectangleWidth),offset:{x:r.transform.canvasDistance(e.rectangleLength)/2,y:r.transform.canvasDistance(e.rectangleWidth)/2},...l});case"POLYGON":return new Pe.RegularPolygon({sides:e.polygonNumSides,radius:r.transform.canvasDistance(e.polygonRadius),...l});case"ELLIPSE":return new Pe.Ellipse({radiusX:r.transform.canvasDistance(e.ellipseLength/2),radiusY:r.transform.canvasDistance(e.ellipseWidth/2),...l});case"LINES":return new Pe.Line({points:e.linesCoordinates.reduce((o,i)=>(o.push(r.transform.canvasXPos(i.x),r.transform.canvasYPos(i.y)),o),[]),closed:e.linesClosed||t,...l})}throw new xt("Geometry type undefined.")}function Zn(r,e,t,n){return Gn(r,e,!0,t)}function Kt(r,e,t){if(t instanceof Pe.Rect)e.rectangleLength&&(t.width(r.transform.canvasDistance(e.rectangleLength)),t.offsetX(r.transform.canvasDistance(e.rectangleLength)/2)),e.rectangleWidth&&(t.height(r.transform.canvasDistance(e.rectangleWidth)),t.offsetY(r.transform.canvasDistance(e.rectangleWidth)/2));else if(t instanceof Pe.RegularPolygon)e.polygonNumSides&&t.sides(e.polygonNumSides),e.polygonRadius&&t.radius(r.transform.canvasDistance(e.polygonRadius));else if(t instanceof Pe.Ellipse)e.ellipseLength&&t.radiusX(r.transform.canvasDistance(e.ellipseLength/2)),e.ellipseWidth&&t.radiusY(r.transform.canvasDistance(e.ellipseWidth/2));else if(t instanceof Pe.Line)e.linesCoordinates&&t.points(e.linesCoordinates.reduce((n,a)=>(n.push(r.transform.canvasXPos(a.x),r.transform.canvasYPos(a.y)),n),[])),e.linesClosed&&t.closed(e.linesClosed);else throw new xt("Geometry shape of an unsupported type.")}function rr(r,e){U(e,!0);let t=me(e,"showName",3,!0);const n=10,a=tt(e.canvasId),l=a.container.getLayer(e.plantingAreaLayerId),o=new Pe.Group({draggable:e.editable});l.add(o);let i=null,m=new Pe.Text({fontFamily:"sans",fontSize:15,opacity:.7,text:e.name,visible:t()});o.add(m);let v=e.geometry.type,d=H(()=>e.selected?Ue("accent",8,Be.current):Ue("brown",10,Be.current)),f=H(()=>e.selected?Ue("accent",5,Be.current):Ue("brown",3,Be.current)),p=H(()=>e.selected?3:2),C=H(()=>e.selected?Ue("accent",11,Be.current):Ue("brown",11,Be.current));Se(()=>{e.geometry.type!==v||!i?(i==null||i.destroy(),i=Zn(a,e.geometry,{stroke:s(d),fill:s(f),strokeWidth:s(p)}),i&&(o.add(i),o.rotation(e.geometry.rotation),m.y(a.transform.canvasYPos(Bt(e.geometry))))):(Kt(a,e.geometry,i),m.y(a.transform.canvasYPos(Bt(e.geometry)))),v=e.geometry.type}),Se(()=>{e.position?(o.position({x:a.transform.canvasXPos(e.position.x),y:a.transform.canvasYPos(e.position.y)}),o.visible(!0)):o.visible(!1)}),Se(()=>{i==null||i.fill(s(f)),i==null||i.stroke(s(d)),i==null||i.strokeWidth(s(p)),m.fill(s(C))}),Se(()=>{m.text(e.name),m.offsetX(m.width()/2),m.offsetY(m.height()+n)}),Se(()=>{e.editable?(o.draggable(!0),i==null||i.on("mouseover",()=>{document.body.style.cursor="move"}),i==null||i.on("mouseout",()=>{a.selectionGroup.setDocumentCursor()}),o.on("dragmove",()=>{e.onTranslate&&e.onTranslate({x:o.x(),y:o.y()},!1)}),o.on("dragend",()=>{o.position(a.gridManager.snapToGrid(o.position())),e.onTranslate&&e.onTranslate({x:o.x(),y:o.y()},!0)}),o.on("pointerclick",()=>{e.onClick&&e.onClick()})):(o.draggable(!1),o.off("mouseover mouseout dragmove dragend pointerclick"))});function h(g,_){i&&Kt(a,g,i),e.onTransform&&e.onTransform(g,_)}Gt(()=>{o.destroy()});var u=N(),b=x(u);{var w=g=>{qn(g,{get canvasId(){return e.canvasId},get geometry(){return e.geometry},get strokeColor(){return s(d)},get fillColor(){return s(f)},geometryGroup:o,onTransform:h})};$(b,g=>{e.editable&&g(w)})}c(r,u),Y()}function Jn(r,e){U(e,!0),tt(e.canvasId).container.addLayer(e.plantingAreaLayerId);var n=N(),a=x(n);ze(a,()=>e.children),c(r,n),Y()}var eo=R("<!> <!>",1);function to(r,e){U(e,!0);var t=N(),n=x(t);y(n,()=>Nr,(a,l)=>{l(a,{children:(o,i)=>{var m=eo(),v=x(m);y(v,()=>Dr,(f,p)=>{p(f,{class:"w-8",children:(C,h)=>{se(C,{get icon(){return et.formFieldDescriptionIcon},width:"1rem",class:"text-destructive-9 hover:text-destructive-10 ml-2"})},$$slots:{default:!0}})});var d=I(v,2);y(d,()=>Hr,(f,p)=>{p(f,{class:"max-w-2xl",children:(C,h)=>{be();var u=pe();ce(b=>Ne(u,b),[()=>e.errors.join(" ")]),c(C,u)},$$slots:{default:!0}})}),c(o,m)},$$slots:{default:!0}})}),c(r,t),Y()}const Ot="/~";function ro(r,e){return`${r}${Ot}${e}`}function He(r,e){return`${r}${Ot}${e}`}function Rt(r){const e=r.split(Ot);if(e.length<2||e.length>3)throw new xt(`Invalid Tree ID format: ${r}`);return e[2]?{entityType:e[0],entityId:e[1],field:e[2]}:{entityType:e[0],entityId:e[1]}}function de(r,e,t,n){const a=Kn(e,t);return a?(n[r]=a,!1):!0}var no=(r,e,t)=>{r.stopPropagation(),!e(r)&&!r.shiftKey&&s(t).tree.clearSelection(),e(r)?s(t).toggleSelect():s(t).tree.select(s(t).id),r.shiftKey&&s(t).tree.selectUntil(s(t).id),s(t).focus()},oo=R('<span class="bg-accent-7 h-3 w-3 rounded-[4px]"></span>'),ao=R('<button aria-label="select" class="border-accent-8 mr-1 flex h-5 w-5 items-center justify-center rounded-[4px] border-2"><!></button>'),so=R('<div class="flex grow items-center"><div class="bg-neutral-3 mx-3 h-[1px] w-full"></div> <!></div>'),io=r=>r.stopPropagation(),lo=r=>r.stopPropagation(),co=R('<div role="none" class="flex w-1/2 items-center"><div class="mr-1 flex items-center"><!></div> <!></div>'),uo=R('<ul><div class="bg-neutral-5 absolute bottom-4 top-4 w-[1px]"></div> <!></ul>'),fo=R('<li><div><div class="flex items-center gap-2 pl-2"><!> <!> <span> </span> <!></div>  <!></div> <!></li>'),go=R("<ul><!></ul>");function vo(r,e){U(e,!0);const t=(m,v=wt,d)=>{let f=Qt(()=>br(d==null?void 0:d(),0));var p=N(),C=x(p);Dt(C,17,v,h=>h.id,(h,u)=>{var b=fo(),w=D=>{D.stopPropagation(),s(u).tree.expandOnClick&&s(u).canExpand&&(!s(u).tree.multiple||!a(D)&&!D.shiftKey)&&s(u).toggleExpand(),s(u).focus()};let g;var _=k(b),K=k(_),X=k(K);{var ae=D=>{var z=ao();z.__click=[no,a,u];var fe=k(z);{var Q=J=>{var _e=oo();c(J,_e)};$(fe,J=>{s(u).selected&&J(Q)})}T(z),c(D,z)};$(X,D=>{Rt(s(u).id).field||D(ae)})}var ie=I(X,2);{var ye=D=>{se(D,{get icon(){return s(u).item.icon},width:"1.25rem"})};$(ie,D=>{s(u).item.icon&&D(ye)})}var O=I(ie,2),V=k(O,!0);T(O);var Z=I(O,2);{var F=D=>{Cr(D,{get description(){return s(u).item.description}})};$(Z,D=>{s(u).item.description&&D(F)})}T(K);var B=I(K,2);{var G=D=>{var z=so(),fe=I(k(z),2);const Q=H(()=>s(u).expanded?"rotate-90":""),J=H(()=>s(u).selected?"hover:bg-accent-5":"hover:bg-neutral-3");se(fe,{get icon(){return et.chevronRight},width:"1rem",get class(){return`${s(Q)??""} ml-2 h-6 w-8 rounded-md p-1  ${s(J)??""}`}}),T(z),c(D,z)},ue=(D,z)=>{{var fe=Q=>{var J=co();J.__click=[io],J.__keydown=[lo];var _e=k(J),kt=k(_e);{var ot=$e=>{to($e,{get errors(){return e.fieldErrors[s(u).id]}})};$(kt,$e=>{Object.keys(e.fieldErrors).includes(s(u).id)&&$e(ot)})}T(_e);var Tt=I(_e,2);const at=H(()=>Object.keys(e.fieldErrors).includes(s(u).id));y(Tt,()=>s(u).item.valueComponent,($e,st)=>{st($e,{get value(){return s(u).item.value},get editing(){return e.editing},get onChange(){return s(u).item.onChange},get errors(){return s(at)}})}),T(J),c(Q,J)};$(D,Q=>{s(u).item.valueComponent&&s(u).item.onChange&&Q(fe)},z)}};$(B,D=>{var z;(z=s(u).children)!=null&&z.length?D(G):D(ue,!1)})}T(_);var xe=I(_,2);{var he=D=>{var z=uo();let fe;var Q=k(z),J=I(Q,2);t(J,()=>s(u).children,()=>s(f)+1),T(z),ce(()=>{fe=Fe(z,fe,{...e.editableTree.tree.group,class:`${s(u).expanded?"h-auto opacity-100":"pointer-events-none h-0 opacity-0"} relative origin-left`}),Ut(Q,`left: ${.5+s(f)*1}rem`)}),c(D,z)};$(xe,D=>{var z;(z=s(u).children)!=null&&z.length&&!s(u).item.value&&D(he)})}T(b),ce(()=>{g=Fe(b,g,{...s(u).attrs,onclick:w,class:"cursor-pointer py-3"}),Le(_,1,`flex justify-between gap-4 rounded-md py-2 pr-2 ${s(f)==0?"":"pl-2"}`),Ut(_,`margin-left: ${s(f)*1}rem`),Ne(V,s(u).item.label)}),c(h,b)}),c(m,p)};function n(){return/mac/i.test(navigator.platform)}function a(m){return n()?m.metaKey:m.ctrlKey}var l=go();let o;var i=k(l);return t(i,()=>e.editableTree.tree.children),T(l),ce(()=>o=Fe(l,o,{...e.editableTree.tree.root,class:"px-2"})),c(r,l),Y({isMac:n,isControlOrMeta:a})}tn(["click","keydown"]);function nr(r,e){U(e,!0);var t=N(),n=x(t);{var a=o=>{ge(o,{class:"flex w-full select-none items-center justify-center",onclick:()=>{e.onChange(void 0)},children:(i,m)=>{se(i,{get icon(){return et.addIcon},width:"1.5rem",class:"text-neutral-11"})},$$slots:{default:!0}})},l=o=>{ge(o,{class:"flex w-full select-none items-center justify-center",disabled:!0,children:(i,m)=>{se(i,{get icon(){return et.addIcon},width:"1.5rem",class:"text-neutral-11"})},$$slots:{default:!0}})};$(n,o=>{e.editing?o(a):o(l,!1)})}c(r,t),Y()}var mo=R('<div><div class="@xs:flex-row flex w-full grid-cols-3 grid-rows-2 flex-col justify-between"><div class="flex w-full"><span class="bg-neutral-2 border-neutral-7 border-r-neutral-5 @xs:rounded-bl-md @xs:border-b flex h-10 w-8 items-center justify-center rounded-l-md rounded-bl-none border border-b-0 border-r-0 px-3 text-sm">X</span> <span class="@xs:border-b @xs:rounded-tr-none border-neutral-7 bg-neutral-1 flex w-full items-center justify-center rounded-l-none rounded-r-none rounded-tr-md border border-b-0"> </span></div> <div class="flex w-full"><span class="bg-neutral-2 border-neutral-7 @xs:border-x-neutral-5 @xs:border-b @xs:border-l-0 flex h-10 w-8 items-center justify-center rounded-none border border-b-0 border-r-0 px-3 text-sm">Y</span> <span class="@xs:border-b border-neutral-7 bg-neutral-1 flex w-full items-center justify-center rounded-l-none rounded-r-none border border-b-0"> </span></div> <span> </span> <!></div></div>');function ho(r,e){U(e,!0);let t=me(e,"decimalPlaces",3,2),n=It(e,["$$slots","$$events","$$legacy","x","y","initialUnitSystem","decimalPlaces"]);const a=Pr("distance",[e.x,e.y],e.initialUnitSystem,t());Se(()=>{a.setDisplayValues([e.x,e.y])});var l=mo();let o;var i=k(l),m=k(i),v=I(k(m),2),d=k(v,!0);T(v),T(m);var f=I(m,2),p=I(k(f),2),C=k(p,!0);T(p),T(f);var h=I(f,2),u=k(h,!0);T(h);var b=I(h,2);y(b,()=>on,(w,g)=>{g(w,{get onclick(){return a.swapUnits},type:"button",class:"border-x-neutral-7 @xs:border-x-neutral-5 bg-neutral-2 hover:bg-neutral-3 @xs:h-10 @xs:w-8 @xs:rounded-none @xs:rounded-r-md flex h-8 w-full items-center justify-center rounded-b-md border px-2",children:(_,K)=>{se(_,{icon:"material-symbols:swap-horiz-rounded",width:"1rem"})},$$slots:{default:!0}})}),T(i),T(l),ce(()=>{o=Fe(l,o,{...n,class:"@container h-full w-full"}),Ne(d,e.x),Ne(C,e.y),Le(h,1,`border-x-neutral-7 @xs:border-x-neutral-5 bg-neutral-2 border-neutral-7 @xs:h-10 @xs:w-8 @xs:border-b @xs:border-l-0 flex h-8 w-full min-w-10 items-center justify-center border-x border-y border-b-0 px-3 ${a.unitSystem==="metric"?"text-lg":"text-md"} text-neutral-11`),Ne(u,a.unitSymbol)}),c(r,l),Y()}function or(r,e){U(e,!0);var t=N(),n=x(t);{var a=o=>{wr(o,{get x(){return e.value.x},get y(){return e.value.y},onValueChange:i=>{e.onChange(i)}})},l=o=>{ho(o,{get x(){return e.value.x},get y(){return e.value.y}})};$(n,o=>{e.editing?o(a):o(l,!1)})}c(r,t),Y()}function po(r,e){U(e,!0);var t=N(),n=x(t);{var a=o=>{Xt(o,{get value(){return e.value},onValueChange:i=>{i&&e.onChange(i)}})},l=o=>{Xt(o,{get value(){return e.value},disabled:!0})};$(n,o=>{e.editing?o(a):o(l,!1)})}c(r,t),Y()}function ar(r,e){U(e,!0);var t=N(),n=x(t);{var a=o=>{ge(o,{class:"bg-destructive-6 text-destructive-12 w-full select-none",onclick:()=>{e.onChange(void 0)},children:(i,m)=>{se(i,{get icon(){return et.deleteIcon},width:"1.5rem",class:"text-neutral-11"})},$$slots:{default:!0}})},l=o=>{ge(o,{class:"bg-destructive-6 text-destructive-12 w-full select-none",disabled:!0,children:(i,m)=>{se(i,{get icon(){return et.deleteIcon},width:"1.5rem",class:"text-neutral-11"})},$$slots:{default:!0}})};$(n,o=>{e.editing?o(a):o(l,!1)})}c(r,t),Y()}var bo=R("<span> </span>");function nt(r,e){var t=bo(),n=k(t,!0);T(t),ce(()=>{Le(t,1,`${e.value?"":"italic"} border-neutral-7 bg-neutral-1 ring-offset-neutral-1 focus-visible:ring-neutral-7 flex w-full rounded-md border px-3 py-2 text-sm focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-offset-2`),Ne(n,e.value||"None")}),c(r,t)}function Ye(r,e){U(e,!0);var t=N(),n=x(t);{var a=o=>{Ir(o,{oninput:i=>{e.onChange(i)},get value(){return e.value},quantityType:"distance"})},l=o=>{nt(o,{get value(){return e.value}})};$(n,o=>{e.editing?o(a):o(l,!1)})}c(r,t),Y()}var yo=R('<div class="item-center flex"><span> </span></div>'),xo=R('<div class="item-center flex"><span> </span></div>'),_o=R("<!> <!>",1);function Co(r,e){U(e,!0);const t=H(()=>e.value.options.find(i=>i.id===e.value.id)??{label:"Make a selection"});var n=N(),a=x(n);{var l=i=>{var m=N(),v=x(m);y(v,()=>cn,(d,f)=>{f(d,{type:"single",get value(){return e.value.id},onValueChange:p=>{e.onChange({id:p,options:e.value.options})},children:(p,C)=>{var h=_o(),u=x(h);y(u,()=>an,(w,g)=>{g(w,{class:"w-full",children:(_,K)=>{var X=yo(),ae=k(X),ie=k(ae,!0);T(ae),T(X),ce(()=>Ne(ie,s(t).label)),c(_,X)},$$slots:{default:!0}})});var b=I(u,2);y(b,()=>sn,(w,g)=>{g(w,{children:(_,K)=>{var X=N(),ae=x(X);y(ae,()=>ln,(ie,ye)=>{ye(ie,{children:(O,V)=>{var Z=N(),F=x(Z);Dt(F,17,()=>e.value.options,qt,(B,G)=>{var ue=N(),xe=x(ue);y(xe,()=>dn,(he,D)=>{D(he,{get value(){return s(G).id},get label(){return s(G).label},children:(z,fe)=>{var Q=xo(),J=k(Q),_e=k(J,!0);T(J),T(Q),ce(()=>Ne(_e,s(G).label)),c(z,Q)},$$slots:{default:!0}})}),c(B,ue)}),c(O,Z)},$$slots:{default:!0}})}),c(_,X)},$$slots:{default:!0}})}),c(p,h)},$$slots:{default:!0}})}),c(i,m)},o=i=>{nt(i,{get value(){return s(t).label}})};$(a,i=>{e.editing?i(l):i(o,!1)})}c(r,n),Y()}function Po(r,e){let t=Me("");var n=N(),a=x(n);{var l=i=>{kr(i,{get value(){return e.value},get onValueChange(){return e.onChange},get label(){return s(t)},set label(m){ve(t,m,!0)}})},o=i=>{nt(i,{get value(){return s(t)}})};$(a,i=>{e.editing?i(l):i(o,!1)})}c(r,n)}function sr(r){return e=>{const t=e.target;t!=null&&t.value&&r(t.value)}}function wo(r){return e=>{const t=e.target;t!=null&&t.value&&r(Number(t.value))}}function Et(r,e){U(e,!0);var t=N(),n=x(t);{var a=o=>{const i=H(()=>wo(e.onChange));er(o,{get value(){return e.value},type:"number",class:"select-none",get oninput(){return s(i)}})},l=o=>{nt(o,{get value(){return e.value}})};$(n,o=>{e.editing?o(a):o(l,!1)})}c(r,t),Y()}function Io(r,e){U(e,!0);var t=N(),n=x(t);{var a=o=>{const i=H(()=>sr(e.onChange));er(o,{get value(){return e.value},class:"select-none",get oninput(){return s(i)}})},l=o=>{nt(o,{get value(){return e.value}})};$(n,o=>{e.editing?o(a):o(l,!1)})}c(r,t),Y()}function ko(r,e){U(e,!0);var t=N(),n=x(t);{var a=o=>{const i=H(()=>sr(e.onChange));rn(o,{get value(){return e.value},class:"select-none",get oninput(){return s(i)}})},l=o=>{nt(o,{get value(){return e.value}})};$(n,o=>{e.editing?o(a):o(l,!1)})}c(r,t),Y()}function To(r,e,t){let n=new Set;function a(o){const i=o.difference(n),m=n.difference(o);for(const v of i){const{entityType:d,entityId:f}=Rt(v);e[d].add(f)}for(const v of m){const{entityType:d,entityId:f}=Rt(v);e[d].remove(f)}n=new Set([...o])}return{tree:new Ur({items:r,expandOnClick:!0,multiple:!0,onSelectedChange:a})}}function So(r,e,t,n){const a=r+`${e.index}/`;if(!e.geometry)return{id:a,label:"Failed to resolve geometry."};const l=a+"type",o=a+"scaleFactor",i=a+"rotation";W.geometryDateSchema.description,Jt(e.geometry.date,At());const m={id:l,label:"Type",description:W.geometryTypeSchema.description,valueComponent:Po,value:e.geometry.type,onChange:h=>{!de(l,h,W.geometryTypeSchema,n.fieldErrors)||!e.geometry||n.updateHandler(e.geometry.id,{type:h})}},v={id:o,label:"Scale Factor",description:W.geometryScaleFactorSchema.description,valueComponent:Et,value:e.geometry.scaleFactor,onChange:h=>{!de(o,h,W.geometryScaleFactorSchema,n.fieldErrors)||!e.geometry||n.updateHandler(e.geometry.id,{scaleFactor:h})}},d={id:i,label:"Rotation",description:W.geometryRotationSchema.description,valueComponent:Et,value:e.geometry.rotation,onChange:h=>{!de(i,h,W.geometryRotationSchema,n.fieldErrors)||!e.geometry||n.updateHandler(e.geometry.id,{rotation:h})}};let f=[];switch(e.geometry.type){case"RECTANGLE":{const h=a+"rectangleLength",u=a+"rectangleWidth";f=[{id:h,label:"Length",description:W.geometryRectangleLengthSchema.description,valueComponent:Ye,value:e.geometry.rectangleLength,onChange:b=>{!de(h,b,W.geometryRectangleLengthSchema,n.fieldErrors)||!e.geometry||n.updateHandler(e.geometry.id,{rectangleLength:b})}},{id:u,label:"Width",description:W.geometryRectangleWidthSchema.description,valueComponent:Ye,value:e.geometry.rectangleWidth,onChange:b=>{!de(u,b,W.geometryRectangleWidthSchema,n.fieldErrors)||!e.geometry||n.updateHandler(e.geometry.id,{rectangleWidth:b})}}];break}case"POLYGON":{const h=a+"polygonNumSides",u=a+"polygonRadius";f=[{id:h,label:"Side Count",description:W.geometryPolygonNumSidesSchema.description,valueComponent:Et,value:e.geometry.polygonNumSides,onChange:b=>{!de(h,b,W.geometryPolygonNumSidesSchema,n.fieldErrors)||!e.geometry||n.updateHandler(e.geometry.id,{polygonNumSides:b})}},{id:u,label:"Radius",description:W.geometryPolygonRadiusSchema.description,valueComponent:Ye,value:e.geometry.polygonRadius,onChange:b=>{!de(u,b,W.geometryPolygonRadiusSchema,n.fieldErrors)||!e.geometry||n.updateHandler(e.geometry.id,{polygonRadius:b})}}];break}case"ELLIPSE":{const h=a+"ellipseLength",u=a+"ellipseWidth";f=[{id:h,label:"Length",description:W.geometryEllipseLengthSchema.description,valueComponent:Ye,value:e.geometry.ellipseLength,onChange:b=>{!de(h,b,W.geometryEllipseLengthSchema,n.fieldErrors)||!e.geometry||n.updateHandler(e.geometry.id,{ellipseLength:b})}},{id:u,label:"Width",description:W.geometryEllipseWidthSchema.description,valueComponent:Ye,value:e.geometry.ellipseWidth,onChange:b=>{!de(u,b,W.geometryEllipseWidthSchema,n.fieldErrors)||!e.geometry||n.updateHandler(e.geometry.id,{ellipseWidth:b})}}];break}case"LINES":{const h=a+"linesCoordinates",u=a+"linesAddCoordinate",b=e.geometry.linesCoordinates.map((g,_)=>{const K=a+`linesCoordinate${_}`,X=K+"/position",ae=K+"/delete",ie={id:X,label:"Position",description:W.coordinateSchema.description,valueComponent:or,value:g,onChange:O=>{if(!de(X,O,W.coordinateSchema,n.fieldErrors)||!e.geometry)return;const V=e.geometry.linesCoordinates;V[_]=O,n.updateHandler(e.geometry.id,{linesCoordinates:V})}},ye={id:ae,label:"Delete",description:"Deletes the coordinate.",valueComponent:ar,value:void 0,onChange:()=>{if(!e.geometry)return;const O=e.geometry.linesCoordinates.filter(V=>V.id!=g.id);n.updateHandler(e.geometry.id,{linesCoordinates:O})}};return{id:K,label:`Coordinate ${_}`,children:[ie,ye]}}),w={id:u,label:"Add Coordinate",valueComponent:nr,value:void 0,onChange:()=>{if(!e.geometry)return;const g=[...e.geometry.linesCoordinates],_={x:g[g.length-1].x+.1,y:g[g.length-1].y+.1};g.push(_),n.updateHandler(e.geometry.id,{linesCoordinates:g})}};W.geometryLinesClosedSchema.description,e.geometry.linesClosed,f=[{id:h,label:"Coordinates",children:[...b,w]}];break}}let p=[];p=[m,v,d,...f];const C=t.includeIndex?`Geometry ${e.index+1}`:"Geometry";return{id:a,label:C,children:p}}function Lo(r,e,t,n){const a=r+`${e.index}/`;if(!e.location)return{id:a,label:"Failed to resolve location."};const l=a+"date",o=a+"coordinate",i=a+"workspace",m=a+"delete",v={id:l,label:"Date",description:W.locationDateSchema.description,valueComponent:po,value:Jt(e.location.date,At()),onChange:h=>{de(l,h,W.locationDateSchema,n.fieldErrors)&&n.updateHandler(e.location.id,{date:h.toDate(At())})}},d={id:o,label:"Position",description:W.coordinateSchema.description,valueComponent:or,value:{x:e.location.x,y:e.location.y},onChange:h=>{de(o,h,W.coordinateSchema,n.fieldErrors)&&n.updateHandler(e.location.id,{coordinate:h})}},f={id:i,label:"Workspace",description:"The workspace the location is located in.",valueComponent:Co,value:{id:e.location.workspaceId,options:e.workspaces.map(h=>({id:h.id,label:h.name}))},onChange:h=>{n.updateHandler(e.location.id,{workspaceId:h.id})}},p={id:m,label:"Delete",description:"Deletes the geometry from the history.",valueComponent:ar,value:void 0,onChange:()=>{n.updateHandler(e.location.id,{delete:!0})}},C=[v,d,f];return t.includeDelete&&C.push(p),{id:a,label:`Location ${e.index+1}`,children:C}}function Eo(r,e,t){const n=He(r,"locations");if(!e.locationHistory)return{id:n,label:"Failed to resolve locations."};const a=He(r,"locationAdd"),l=e.locationHistory.locations.map((i,m)=>{var f;const v=(f=e.locationHistory)==null?void 0:f.locations.length,d=!!(v&&v>1);return Lo(n,{location:i,workspaces:e.workspaces,index:m},{includeDelete:d},{updateHandler:t.locationUpdateHandler,fieldErrors:t.fieldErrors})}),o={id:a,label:"Add",description:"Adds a new location to the history.",valueComponent:nr,value:void 0,onChange:()=>{e.locationHistory&&t.onLocationHistoryExtend(e.locationHistory.id)}};return{id:n,label:"Locations",children:[...l,o]}}async function Ao({params:r}){const e=await it.fetchOne(fr.Vars({gardenId:r.gardenId,workspaceSlug:r.workspaceSlug}));if(!e)throw ur(`/gardens/${r.gardenId}/workspaces`),new xt(`Workspace ${r.workspaceSlug} does not exist`);return{workspace:e}}const wa=Object.freeze(Object.defineProperty({__proto__:null,load:Ao},Symbol.toStringTag,{value:"Module"}));function Ro(r,e){U(e,!0);const[t,n]=_r(),a=()=>xr(i,"$formData",t),l=rt(),o=l.layoutCanvasContext,{form:i}=l.plantingAreaCreateForm.form;function m(d){We(i,le(a).location.coordinate={x:o.transform.modelXPos(d.x),y:o.transform.modelYPos(d.y)},le(a))}function v(d){d.rectangleLength&&We(i,le(a).geometry.rectangleLength=d.rectangleLength,le(a)),d.rectangleWidth&&We(i,le(a).geometry.rectangleWidth=d.rectangleWidth,le(a)),d.polygonNumSides&&We(i,le(a).geometry.polygonNumSides=d.polygonNumSides,le(a)),d.polygonRadius&&We(i,le(a).geometry.polygonRadius=d.polygonRadius,le(a)),d.ellipseLength&&We(i,le(a).geometry.ellipseLength=d.ellipseLength,le(a)),d.ellipseWidth&&We(i,le(a).geometry.ellipseWidth=d.ellipseWidth,le(a)),d.linesCoordinates&&d.linesCoordinates&&We(i,le(a).geometry.linesCoordinates=d.linesCoordinates,le(a))}rr(r,{get canvasId(){return o.canvasId},get plantingAreaLayerId(){return e.plantingAreaLayerId},get name(){return a().name},showName:!0,get position(){return a().location.coordinate},get geometry(){return a().geometry},editable:!0,selected:!0,onTranslate:m,onTransform:v}),Y(),n()}function Do(r,e){U(e,!0);const t=rt(),n=t.layoutCanvasContext,a=n.canvasId,l=Pt(it,gr.Vars({plantingAreaId:e.plantingAreaId})),o=Xe(Or),i=Xe(Zt);let m=H(()=>l.results&&l.results[0]?l.results[0]:null),v=H(()=>{var w;if(s(m)&&s(m).locationHistory){const g=$r((w=s(m).locationHistory)==null?void 0:w.locations,t.timelineSelection.focusUtc);return g&&g.workspaceId===t.id?{x:g.x,y:g.y}:null}else return null}),d=H(()=>t.editing&&!lt.isToolActive("plantingAreaCreate")),f=H(()=>t.selections.has("plantingArea",e.plantingAreaId));function p(w){!s(m)||!t.id||o.execute({id:s(m).locationHistoryId,workspaceId:t.id,coordinate:{x:n.transform.modelXPos(w.x),y:n.transform.modelYPos(w.y)},date:t.timelineSelection.focusUtc})}function C(w){s(m)&&i.execute(s(m).geometryId,w)}var h=N(),u=x(h);{var b=w=>{rr(w,{canvasId:a,get plantingAreaLayerId(){return e.plantingAreaLayerId},get name(){return s(m).name},showName:!0,get position(){return s(v)},get geometry(){return s(m).geometry},get editable(){return s(d)},get selected(){return s(f)},onTranslate:p,onTransform:C,onClick:()=>{lt.isToolActive("plantingAreaCreate")||t.selections.select("plantingArea",e.plantingAreaId)}})};$(u,w=>{s(m)&&s(m).geometry&&w(b)})}c(r,h),Y()}var Ho=R("<!> <!>",1),No=R("<!> <!>",1);function zo(r,e){U(e,!0);const t=i=>{Vn(i,{canvasId:l})},l=rt().layoutCanvasContext.canvasId,o="plantingAreas";fn(r,{canvasId:l,overlay:t,children:(i,m)=>{var v=No(),d=x(v);gn(d,{canvasId:l});var f=I(d,2);Jn(f,{canvasId:l,plantingAreaLayerId:o,children:(p,C)=>{var h=Ho(),u=x(h);{var b=g=>{Ro(g,{plantingAreaLayerId:o})};$(u,g=>{lt.isToolActive("plantingAreaCreate")&&g(b)})}var w=I(u,2);Dt(w,17,()=>e.plantingAreaIds,qt,(g,_)=>{Do(g,{get plantingAreaId(){return s(_)},plantingAreaLayerId:o})}),c(p,h)},$$slots:{default:!0}}),c(i,v)},$$slots:{default:!0}}),Y()}var Wo=R('<span class="p-2 italic">No planting areas.</span>');function $o(r,e){U(e,!0);const t=rt(),n=yr({});let a=H(()=>Pt(it,vr.Vars({ids:e.plantingAreaIds}))),l=H(()=>Pt(it,mr.Vars({gardenId:en.params.gardenId}))),o=H(()=>{var g;return((g=s(l).results)==null?void 0:g.map(_=>({id:_.id,name:_.name})))||[]});const i=Xe(jr.mutation),m=Xe(Zt),v=Xe(Fr),d=Xe(Mr);function f(g){const _=ro("plantingArea",g.id),K=He(_,"name"),X=He(_,"description"),ae=He(_,"depth"),ie=So(He(_,"geometry"),{geometry:g.geometry,index:0},{includeIndex:!1},{updateHandler:(F,B)=>{m.execute(F,B)},fieldErrors:n}),ye=Eo(_,{locationHistory:g.locationHistory,workspaces:s(o)},{locationUpdateHandler:(F,B)=>{v.execute(F,B)},onLocationHistoryExtend:F=>{d.execute(F,t.timelineSelection.focusUtc)},fieldErrors:n}),O={id:K,label:"Name",description:W.plantingAreaNameSchema.description,valueComponent:Io,value:g.name,onChange:F=>{de(K,F,W.plantingAreaNameSchema,n)&&i.execute(g.id,{name:F})}},V={id:X,label:"Description",description:W.plantingAreaDescriptionSchema.description,valueComponent:ko,value:g.description,onChange:F=>{de(X,F,W.plantingAreaDescriptionSchema,n)&&i.execute(g.id,{description:F})}},Z={id:ae,label:"Depth",description:W.plantingAreaDepthSchema.description,valueComponent:Ye,value:g.depth,onChange:F=>{de(ae,F,W.plantingAreaDepthSchema,n)&&i.execute(g.id,{depth:F})}};return{id:_,label:g.name,children:[O,{id:He(_,"details"),label:"Details",children:[V,Z]},ie,ye]}}let p=H(()=>(s(a).results||[]).map(g=>f(g)));const C=To(()=>s(p),{plantingArea:{add:g=>{t.selections.select("plantingArea",g)},remove:g=>{t.selections.deselect("plantingArea",g)}}});t.selections.addSelectionChangeHandler("plantingArea",(g,_)=>{g.forEach(K=>{C.tree.select(He("plantingArea",K))}),_.forEach(K=>{C.tree.deselect(He("plantingArea",K))})});var h=N(),u=x(h);{var b=g=>{var _=Wo();c(g,_)},w=g=>{var _=N(),K=x(_);y(K,()=>nn,(X,ae)=>{ae(X,{class:"h-full w-full px-2",children:(ie,ye)=>{vo(ie,{editableTree:C,get fieldErrors(){return n},get editing(){return t.editing}})},$$slots:{default:!0}})}),c(g,_)};$(u,g=>{e.plantingAreaIds.length===0?g(b):g(w,!1)})}c(r,h),Y()}var Oo=R("<!> <!>",1);function jo(r,e){var t=N(),n=x(t);y(n,()=>Yr,(a,l)=>{l(a,{value:"plantingAreas",class:"bg-neutral-1 flex h-full flex-col",children:(o,i)=>{var m=Oo(),v=x(m);y(v,()=>Xr,(f,p)=>{p(f,{class:"h-8 shadow-none",children:(C,h)=>{var u=N(),b=x(u);y(b,()=>Vr,(w,g)=>{g(w,{value:"plantingAreas",class:"border-neutral-5 text-neutral-11 flex w-full items-center justify-between border-b p-0 px-4 py-1",children:(_,K)=>{be();var X=pe("Planting Areas");c(_,X)},$$slots:{default:!0}})}),c(C,u)},$$slots:{default:!0}})});var d=I(v,2);y(d,()=>Kr,(f,p)=>{p(f,{value:"plantingAreas",class:"mt-0 overflow-hidden",children:(C,h)=>{$o(C,{get plantingAreaIds(){return e.plantingAreaIds}})},$$slots:{default:!0}})}),c(o,m)},$$slots:{default:!0}})}),c(r,t)}var Mo=R("<!> <!>",1),Fo=R("<!> <!>",1),Bo=R("<!> <!> <!>",1),Uo=R('<div class="flex h-full w-full flex-col"><div class="h-full grow overflow-hidden"><!></div> <div class="bottom-0 h-24"><!></div></div>');function Yo(r,e){U(e,!0);const t=rt();let n=Me(!0);Se(()=>{t.contentPaneDirection&&(ve(n,!1),ve(n,!0))});const a=Pt(it,hr.Vars({workspaceId:t.id}));var l=Uo(),o=k(l),i=k(o);{var m=f=>{var p=N(),C=x(p);y(C,()=>Gr,(h,u)=>{u(h,{get direction(){return t.contentPaneDirection},children:(b,w)=>{var g=Bo(),_=x(g);{var K=O=>{var V=Mo(),Z=x(V);y(Z,()=>Lt,(B,G)=>{G(B,{defaultSize:70,order:1,minSize:10,children:(ue,xe)=>{var he=N(),D=x(he);zr(D,()=>t.id,z=>{const fe=H(()=>{var Q;return((Q=a.results)==null?void 0:Q.map(J=>J.id))||[]});zo(z,{get plantingAreaIds(){return s(fe)}})}),c(ue,he)},$$slots:{default:!0}})});var F=I(Z,2);y(F,()=>Vt,(B,G)=>{G(B,{withHandle:!1})}),c(O,V)};$(_,O=>{t.layoutEnabled&&O(K)})}var X=I(_,2);{var ae=O=>{var V=Fo(),Z=x(V);y(Z,()=>Lt,(B,G)=>{G(B,{defaultSize:20,order:2,minSize:10,children:(ue,xe)=>{qr(ue,{toolbox:lt})},$$slots:{default:!0}})});var F=I(Z,2);y(F,()=>Vt,(B,G)=>{G(B,{withHandle:!1})}),c(O,V)};$(X,O=>{lt.isActive&&O(ae)})}var ie=I(X,2);{var ye=O=>{var V=N(),Z=x(V);y(Z,()=>Lt,(F,B)=>{B(F,{defaultSize:30,order:3,minSize:10,children:(G,ue)=>{const xe=H(()=>{var he;return((he=a.results)==null?void 0:he.map(D=>D.id))||[]});jo(G,{get plantingAreaIds(){return s(xe)}})},$$slots:{default:!0}})}),c(O,V)};$(ie,O=>{t.treeEnabled&&O(ye)})}c(b,g)},$$slots:{default:!0}})}),c(f,p)};$(i,f=>{s(n)&&f(m)})}T(o);var v=I(o,2),d=k(v);Qr(d,{get selection(){return t.timelineSelection}}),T(v),T(l),c(r,l),Y()}function Ia(r,e){U(e,!0);const t=rt();Se(()=>{t.id!=e.data.workspace.id&&t.setWorkspace(e.data.workspace.id)});var n=N(),a=x(n);{var l=o=>{Yo(o,{})};$(a,o=>{t.id&&o(l)})}c(r,n),Y()}export{Ia as component,wa as universal};
