var lr=Object.defineProperty;var jt=r=>{throw TypeError(r)};var dr=(r,e,t)=>e in r?lr(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var xt=(r,e,t)=>dr(r,typeof e!="symbol"?e+"":e,t),Mt=(r,e,t)=>e.has(r)||jt("Cannot "+t);var P=(r,e,t)=>(Mt(r,e,"read from private field"),t?t.call(r):e.get(r)),q=(r,e,t)=>e.has(r)?jt("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(r):e.set(r,t),we=(r,e,t,n)=>(Mt(r,e,"write to private field"),n?n.call(r,t):e.set(r,t),t);import{A as yt,w as W,t as st}from"../chunks/Dk6orzBZ.js";import{g as cr}from"../chunks/Cqi9girw.js";import{a as ur,b as fr,c as gr,w as mr,d as vr}from"../chunks/BiSaNKIP.js";import{t as R,a as u,c as N,b as pe}from"../chunks/BLh5GmnI.js";import{p as U,aT as et,c as k,r as T,s as I,t as ue,a as Y,f as _,d as Me,g as i,b as ve,a7 as H,Y as hr,u as Se,P as Pt,a2 as Kt,n as be,aR as pr,e as le,a6 as br}from"../chunks/DHe4-ApK.js";import{i as $,p as ce,r as wt,b as yr,c as xr,a as We}from"../chunks/B_kr4MhJ.js";import{K as Pe,r as De,F as _r,c as Cr,C as Pr,U as wr,G as Ir,g as tt,t as it}from"../chunks/Cd3O87VX.js";import{f as kr,S as Tr,g as Sr,w as Lr,n as Er,h as Ar,T as Rr,P as Dr,R as Hr,N as Nr}from"../chunks/CzXzmWml.js";import{c as x}from"../chunks/kXQwtSo-.js";import{u as Ct}from"../chunks/DKTCaoP2.js";import{a as Je,e as Rt,i as Qt}from"../chunks/C2bVma-z.js";import{o as zr,a as qt}from"../chunks/Cfcy5gmN.js";import{g as Ft,h as Wr,a as Gt,l as $r,p as Or,b as jr,c as Mr}from"../chunks/B9JzETbW.js";import{e as Be,f as Zt,h as Et}from"../chunks/Bi19raez.js";import{c as Ye}from"../chunks/WYaP-8ZL.js";import{s as ze}from"../chunks/D_zK8O_D.js";import{e as Fr,s as Fe,a as Le,c as _t,d as Bt}from"../chunks/C5DQ7Oew.js";import{e as Ut,i as Ie,D as Yt,T as Br,j as Ur,k as Yr,l as Xr,m as Vr,g as Kr,P as St,f as Xt,h as Qr,R as qr}from"../chunks/ogBPammY.js";import{b as Gr}from"../chunks/DyPfmwiR.js";import{s as Ne}from"../chunks/DyNanOjA.js";import{I as se}from"../chunks/Dw6g7VJb.js";import{B as me}from"../chunks/BCOlZh0G.js";import{a as Dt,i as Ht,e as Nt,f as Zr,u as zt,b as Ae,m as Wt}from"../chunks/lJMWX_8E.js";import{T as ke,R as Te}from"../chunks/vRN8gt_X.js";import{p as Jr}from"../chunks/CAwYUMnN.js";import{f as en}from"../chunks/D7mGbQuf.js";import{I as Jt}from"../chunks/jh9C4nA6.js";import{T as tn}from"../chunks/CprMCzK2.js";import{S as rn}from"../chunks/DnVoG7GS.js";import{B as nn}from"../chunks/C7SjzIOH.js";import{S as on,a as an,G as sn,b as ln,R as dn}from"../chunks/BooCbkVG.js";var cn=R('<div class="relative h-full w-full"><div class="absolute left-[0.5px] top-0 h-full w-full"><!></div> <div class="pointer-events-none absolute left-[0.5px] top-0 z-10 h-full w-full"><!></div></div>');function un(r,e){U(e,!0);const t=et(e.canvasId);let n;zr(()=>{t.initialize();const c=new ResizeObserver(t.container.onResize);return c.observe(n),()=>{c.unobserve(n),c.disconnect()}});var o=cn(),s=k(o),a=k(s);{var l=c=>{var g=N(),p=_(g);ze(p,()=>e.children),u(c,g)};$(a,c=>{t.container.initialized&&c(l)})}T(s),Gr(s,c=>n=c,()=>n);var d=I(s,2),f=k(d);ze(f,()=>e.overlay),T(d),T(o),ue(()=>Fr(s,"id",e.canvasId)),Ut(o,"clientWidth",c=>t.container.width=c),Ut(o,"clientHeight",c=>t.container.height=c),u(r,o),Y()}function fn(r,e){U(e,!0),et(e.canvasId).gridManager.initialize(),Y()}const gn="data-collapsible-root",mn="data-collapsible-content",vn="data-collapsible-trigger";var Xe,lt,dt,ct,ut;class hn{constructor(e){q(this,Xe);q(this,lt);xt(this,"open");xt(this,"disabled");q(this,dt,Me(null));q(this,ct,Me(void 0));q(this,ut,H(()=>({id:P(this,Xe).current,"data-state":Nt(this.open.current),"data-disabled":Ht(this.disabled.current),[gn]:""})));this.open=e.open,this.disabled=e.disabled,we(this,Xe,e.id),we(this,lt,e.ref),this.toggleOpen=this.toggleOpen.bind(this),Dt({id:P(this,Xe),ref:P(this,lt)})}get contentNode(){return i(P(this,dt))}set contentNode(e){ve(P(this,dt),e,!0)}get contentId(){return i(P(this,ct))}set contentId(e){ve(P(this,ct),e,!0)}toggleOpen(){this.open.current=!this.open.current}get props(){return i(P(this,ut))}set props(e){ve(P(this,ut),e)}}Xe=new WeakMap,lt=new WeakMap,dt=new WeakMap,ct=new WeakMap,ut=new WeakMap;var Ve,Oe,Ke,Qe,qe,Ge,ft,gt,mt,vt;class pn{constructor(e,t){q(this,Ve);q(this,Oe);xt(this,"root");q(this,Ke);q(this,Qe,Me(!1));q(this,qe,Me(0));q(this,Ge,Me(0));q(this,ft);q(this,gt,H(()=>P(this,ft).current||this.root.open.current));q(this,mt,H(()=>({open:this.root.open.current})));q(this,vt,H(()=>({id:P(this,Ve).current,style:{"--bits-collapsible-content-height":i(P(this,Ge))?`${i(P(this,Ge))}px`:void 0,"--bits-collapsible-content-width":i(P(this,qe))?`${i(P(this,qe))}px`:void 0},"data-state":Nt(this.root.open.current),"data-disabled":Ht(this.root.disabled.current),[mn]:""})));this.root=t,ve(P(this,Qe),t.open.current,!0),we(this,ft,e.forceMount),we(this,Ve,e.id),we(this,Oe,e.ref),Dt({id:P(this,Ve),ref:P(this,Oe),deps:()=>this.present,onRefChange:n=>{this.root.contentNode=n,this.root.contentId=n==null?void 0:n.id}}),hr(()=>{const n=requestAnimationFrame(()=>{ve(P(this,Qe),!1)});return()=>{cancelAnimationFrame(n)}}),Se(()=>{this.present;const n=P(this,Oe).current;n&&Lr(()=>{if(!P(this,Oe).current)return;we(this,Ke,P(this,Ke)||{transitionDuration:n.style.transitionDuration,animationName:n.style.animationName}),n.style.transitionDuration="0s",n.style.animationName="none";const o=n.getBoundingClientRect();if(ve(P(this,Ge),o.height,!0),ve(P(this,qe),o.width,!0),!i(P(this,Qe))){const{animationName:s,transitionDuration:a}=P(this,Ke);n.style.transitionDuration=a,n.style.animationName=s}})})}get present(){return i(P(this,gt))}set present(e){ve(P(this,gt),e)}get snippetProps(){return i(P(this,mt))}set snippetProps(e){ve(P(this,mt),e)}get props(){return i(P(this,vt))}set props(e){ve(P(this,vt),e)}}Ve=new WeakMap,Oe=new WeakMap,Ke=new WeakMap,Qe=new WeakMap,qe=new WeakMap,Ge=new WeakMap,ft=new WeakMap,gt=new WeakMap,mt=new WeakMap,vt=new WeakMap;var Ee,ht,Ze,pt,je,bt;class bn{constructor(e,t){q(this,Ee);q(this,ht);q(this,Ze);q(this,pt);q(this,je,H(()=>P(this,pt).current||P(this,Ee).disabled.current));q(this,bt,H(()=>({id:P(this,Ze).current,type:"button",disabled:i(P(this,je)),"aria-controls":P(this,Ee).contentId,"aria-expanded":Zr(P(this,Ee).open.current),"data-state":Nt(P(this,Ee).open.current),"data-disabled":Ht(i(P(this,je))),[vn]:"",onclick:this.onclick,onkeydown:this.onkeydown})));we(this,Ee,t),we(this,Ze,e.id),we(this,ht,e.ref),we(this,pt,e.disabled),this.onclick=this.onclick.bind(this),this.onkeydown=this.onkeydown.bind(this),Dt({id:P(this,Ze),ref:P(this,ht)})}onclick(e){if(!i(P(this,je))){if(e.button!==0)return e.preventDefault();P(this,Ee).toggleOpen()}}onkeydown(e){i(P(this,je))||(e.key===Tr||e.key===Sr)&&(e.preventDefault(),P(this,Ee).toggleOpen())}get props(){return i(P(this,bt))}set props(e){ve(P(this,bt),e)}}Ee=new WeakMap,ht=new WeakMap,Ze=new WeakMap,pt=new WeakMap,je=new WeakMap,bt=new WeakMap;const[yn,er]=kr("Collapsible.Root");function xn(r){return yn(new hn(r))}function _n(r){const e=er();return new bn(r,e)}function Cn(r){const e=er();return new pn(r,e)}var Pn=R("<div><!></div>");function wn(r,e){U(e,!0);let t=ce(e,"id",19,zt),n=ce(e,"ref",15,null),o=ce(e,"open",15,!1),s=ce(e,"disabled",3,!1),a=ce(e,"controlledOpen",3,!1),l=ce(e,"onOpenChange",3,Er),d=wt(e,["$$slots","$$events","$$legacy","children","child","id","ref","open","disabled","controlledOpen","onOpenChange"]);const f=xn({open:Ae.with(()=>o(),m=>{a()||o(m),l()(m)}),disabled:Ae.with(()=>s()),id:Ae.with(()=>t()),ref:Ae.with(()=>n(),m=>n(m))}),c=H(()=>Wt(d,f.props));var g=N(),p=_(g);{var C=m=>{var b=N(),w=_(b);ze(w,()=>e.child,()=>({props:i(c)})),u(m,b)},h=m=>{var b=Pn();let w;var v=k(b);ze(v,()=>e.children??Pt),T(b),ue(()=>w=Fe(b,w,{...i(c)})),u(m,b)};$(p,m=>{e.child?m(C):m(h,!1)})}u(r,g),Y()}var In=R("<div><!></div>");function kn(r,e){U(e,!0);let t=ce(e,"ref",15,null),n=ce(e,"forceMount",3,!1),o=ce(e,"id",19,zt),s=wt(e,["$$slots","$$events","$$legacy","child","ref","forceMount","children","id"]);const a=Cn({id:Ae.with(()=>o()),forceMount:Ae.with(()=>n()),ref:Ae.with(()=>t(),l=>t(l))});Ar(r,{forceMount:!0,get present(){return a.present},get id(){return o()},presence:(d,f)=>{let c=()=>f==null?void 0:f().present;var g=N();const p=H(()=>Wt(s,a.props,{hidden:n()?void 0:!c().current}));var C=_(g);{var h=b=>{var w=N(),v=_(w),y=Kt(()=>({...a.snippetProps,props:i(p)}));ze(v,()=>e.child,()=>i(y)),u(b,w)},m=b=>{var w=In();let v;var y=k(w);ze(y,()=>e.children??Pt),T(w),ue(()=>v=Fe(w,v,{...i(p)})),u(b,w)};$(C,b=>{e.child?b(h):b(m,!1)})}u(d,g)},$$slots:{presence:!0}}),Y()}var Tn=R("<button><!></button>");function Sn(r,e){U(e,!0);let t=ce(e,"ref",15,null),n=ce(e,"id",19,zt),o=ce(e,"disabled",3,!1),s=wt(e,["$$slots","$$events","$$legacy","children","child","ref","id","disabled"]);const a=_n({id:Ae.with(()=>n()),ref:Ae.with(()=>t(),p=>t(p)),disabled:Ae.with(()=>o())}),l=H(()=>Wt(s,a.props));var d=N(),f=_(d);{var c=p=>{var C=N(),h=_(C);ze(h,()=>e.child,()=>({props:i(l)})),u(p,C)},g=p=>{var C=Tn();let h;var m=k(C);ze(m,()=>e.children??Pt),T(C),ue(()=>h=Fe(C,h,{...i(l)})),u(p,C)};$(f,p=>{e.child?p(c):p(g,!1)})}u(r,d),Y()}const Ln=wn,En=Sn,An=kn;var Rn=R("<!> <!>",1),Dn=R('<span class="bg-neutral-1 text-neutral-11 border-neutral-6 flex h-6 w-auto items-center justify-center border-b border-t px-1 py-0.5 text-sm"> </span>'),Hn=R("<!> <!>",1),Nn=R("<!> <!>",1),zn=R("<!> <!>",1),Wn=R("<!> <!>",1),$n=R("<!> <!>",1),On=R("<!> <!>",1),jn=R("<!> <!>",1),Mn=R("<!> <!>",1),Fn=R("<!> <!>",1),Bn=R('<div><div class="flex items-center"><!> <!> <!></div> <div><div><!></div> <div><!></div> <div><!></div> <div><!></div></div> <div><!></div> <div><!></div> <div><!></div></div>'),Un=R("<!> <!> <!>",1),Yn=R("<div><!></div>");function Xn(r,e){U(e,!0);let t=et(e.canvasId);const n=400;let o=H(()=>t.container.width<n?"vertical":"horizontal"),s=H(()=>{switch(t.transform.config.buttonsPosition){case"bl":return"justify-start items-end";case"br":return"justify-end items-end";case"tl":return"justify-start items-start";case"tr":return"justify-end items-start"}}),a=H(()=>{switch(i(o)){case"horizontal":switch(t.transform.config.buttonsPosition){case"bl":return"flex-row";case"br":return"flex-row-reverse";case"tl":return"flex-row";case"tr":return"flex-row-reverse"}break;case"vertical":switch(t.transform.config.buttonsPosition){case"bl":return"flex-col-reverse";case"br":return"flex-col-reverse";case"tl":return"flex-col";case"tr":return"flex-col"}break}}),l=H(()=>{switch(i(o)){case"horizontal":switch(t.transform.config.buttonsPosition){case"bl":return"items-end";case"br":return"items-end";case"tl":return"items-start";case"tr":return"items-start"}break;case"vertical":switch(t.transform.config.buttonsPosition){case"bl":return"items-start";case"br":return"items-end";case"tl":return"items-start";case"tr":return"items-end"}break}}),d=H(()=>{switch(i(o)){case"horizontal":switch(t.transform.config.buttonsPosition){case"bl":return t.transform.config.buttonsExpanded?"rotate-180":"rotate-10";case"br":return t.transform.config.buttonsExpanded?"rotate-0":"rotate-180";case"tl":return t.transform.config.buttonsExpanded?"rotate-180":"rotate-0";case"tr":return t.transform.config.buttonsExpanded?"rotate-0":"rotate-180"}break;case"vertical":switch(t.transform.config.buttonsPosition){case"bl":return t.transform.config.buttonsExpanded?"-rotate-90":"rotate-90";case"br":return t.transform.config.buttonsExpanded?"-rotate-90":"rotate-90";case"tl":return t.transform.config.buttonsExpanded?"rotate-90":"-rotate-90";case"tr":return t.transform.config.buttonsExpanded?"rotate-90":"-rotate-90"}break}});var f=Yn(),c=k(f);x(c,()=>Te,(g,p)=>{p(g,{delayDuration:800,children:(C,h)=>{var m=N(),b=_(m);x(b,()=>Ln,(w,v)=>{v(w,{get class(){return`z-50 flex ${i(a)??""} ${i(l)??""} justify-start gap-2`},get open(){return t.transform.config.buttonsExpanded},set open(y){t.transform.config.buttonsExpanded=y},children:(y,X)=>{var V=Un(),ae=_(V);x(ae,()=>ke,(O,K)=>{K(O,{class:"order-last",children:(Z,F)=>{var B=N(),G=_(B);x(G,()=>En,(fe,xe)=>{xe(fe,{children:(he,D)=>{me(he,{variant:"outline",size:"xsm",class:"hover:bg-secondary-5 bg-neutral-1 hover:text-secondary-12 pointer-events-auto flex items-center justify-center",children:(z,ge)=>{se(z,{icon:"material-symbols:double-arrow",width:"3rem",get class(){return`${i(d)??""} text-neutral-11 transition-transform`}})},$$slots:{default:!0}})},$$slots:{default:!0}})}),u(Z,B)},$$slots:{default:!0}})});var ie=I(ae,2);x(ie,()=>Ie,(O,K)=>{K(O,{children:(Z,F)=>{be();var B=pe("Toggle Layout Controls");u(Z,B)},$$slots:{default:!0}})});var ye=I(ie,2);x(ye,()=>An,(O,K)=>{K(O,{children:(Z,F)=>{var B=Bn(),G=k(B),fe=k(G);x(fe,()=>Te,(ee,te)=>{te(ee,{children:(re,Re)=>{var j=Rn(),M=_(j);x(M,()=>ke,(L,E)=>{E(L,{children:(A,oe)=>{me(A,{onclick:()=>{t.transform.addScale(-.1)},variant:"outline",size:"xsm",class:"hover:bg-secondary-5 bg-neutral-1 hover:text-secondary-12 border-r-neutral-4 pointer-events-auto flex items-center justify-center rounded-r-none",children:(S,Ce)=>{se(S,{icon:"material-symbols:zoom-out",width:"3rem",class:"text-neutral-11"})},$$slots:{default:!0}})},$$slots:{default:!0}})});var ne=I(M,2);x(ne,()=>Ie,(L,E)=>{E(L,{children:(A,oe)=>{be();var S=pe("Zoom out");u(A,S)},$$slots:{default:!0}})}),u(re,j)},$$slots:{default:!0}})});var xe=I(fe,2);x(xe,()=>Te,(ee,te)=>{te(ee,{children:(re,Re)=>{var j=Hn(),M=_(j);x(M,()=>ke,(L,E)=>{E(L,{children:(A,oe)=>{var S=Dn(),Ce=k(S);T(S),ue(Tt=>Ne(Ce,`${Tt??""}
									%`),[()=>Math.trunc(t.transform.scaleFactor.x*100)]),u(A,S)},$$slots:{default:!0}})});var ne=I(M,2);x(ne,()=>Ie,(L,E)=>{E(L,{children:(A,oe)=>{be();var S=pe("Current zoom percentage");u(A,S)},$$slots:{default:!0}})}),u(re,j)},$$slots:{default:!0}})});var he=I(xe,2);x(he,()=>Te,(ee,te)=>{te(ee,{children:(re,Re)=>{var j=Nn(),M=_(j);x(M,()=>ke,(L,E)=>{E(L,{children:(A,oe)=>{me(A,{onclick:()=>{t.transform.addScale(.1)},variant:"outline",size:"xsm",class:"hover:bg-secondary-5 bg-neutral-1 hover:text-secondary-12 border-l-neutral-4 pointer-events-auto flex items-center justify-center rounded-l-none",children:(S,Ce)=>{se(S,{icon:"material-symbols:zoom-in",width:"3rem",class:"text-neutral-11"})},$$slots:{default:!0}})},$$slots:{default:!0}})});var ne=I(M,2);x(ne,()=>Ie,(L,E)=>{E(L,{children:(A,oe)=>{be();var S=pe("Zoom in");u(A,S)},$$slots:{default:!0}})}),u(re,j)},$$slots:{default:!0}})}),T(G);var D=I(G,2),z=k(D),ge=k(z);x(ge,()=>Te,(ee,te)=>{te(ee,{children:(re,Re)=>{var j=zn(),M=_(j);x(M,()=>ke,(L,E)=>{E(L,{children:(A,oe)=>{me(A,{onclick:()=>{t.transform.translate({x:120,y:0})},variant:"outline",size:"xsm",class:"hover:bg-secondary-5 bg-neutral-1 hover:text-secondary-12 pointer-events-auto flex items-center justify-center",children:(S,Ce)=>{se(S,{icon:"material-symbols:arrow-back-2",width:"3rem",class:"text-neutral-11"})},$$slots:{default:!0}})},$$slots:{default:!0}})});var ne=I(M,2);x(ne,()=>Ie,(L,E)=>{E(L,{children:(A,oe)=>{be();var S=pe("Move Left");u(A,S)},$$slots:{default:!0}})}),u(re,j)},$$slots:{default:!0}})}),T(z);var Q=I(z,2),J=k(Q);x(J,()=>Te,(ee,te)=>{te(ee,{children:(re,Re)=>{var j=Wn(),M=_(j);x(M,()=>ke,(L,E)=>{E(L,{children:(A,oe)=>{me(A,{onclick:()=>{t.transform.translate({x:0,y:120})},variant:"outline",size:"xsm",class:"hover:bg-secondary-5 bg-neutral-1 hover:text-secondary-12 pointer-events-auto flex items-center justify-center",children:(S,Ce)=>{se(S,{icon:"material-symbols:arrow-back-2",width:"3rem",class:"text-neutral-11 rotate-90"})},$$slots:{default:!0}})},$$slots:{default:!0}})});var ne=I(M,2);x(ne,()=>Ie,(L,E)=>{E(L,{children:(A,oe)=>{be();var S=pe("Move up");u(A,S)},$$slots:{default:!0}})}),u(re,j)},$$slots:{default:!0}})}),T(Q);var _e=I(Q,2),It=k(_e);x(It,()=>Te,(ee,te)=>{te(ee,{children:(re,Re)=>{var j=$n(),M=_(j);x(M,()=>ke,(L,E)=>{E(L,{children:(A,oe)=>{me(A,{onclick:()=>{t.transform.translate({x:-120,y:0})},variant:"outline",size:"xsm",class:"hover:bg-secondary-5 bg-neutral-1 hover:text-secondary-12 pointer-events-auto flex items-center justify-center",children:(S,Ce)=>{se(S,{icon:"material-symbols:arrow-back-2",width:"3rem",class:"text-neutral-11 rotate-180"})},$$slots:{default:!0}})},$$slots:{default:!0}})});var ne=I(M,2);x(ne,()=>Ie,(L,E)=>{E(L,{children:(A,oe)=>{be();var S=pe("Move right");u(A,S)},$$slots:{default:!0}})}),u(re,j)},$$slots:{default:!0}})}),T(_e);var nt=I(_e,2),kt=k(nt);x(kt,()=>Te,(ee,te)=>{te(ee,{children:(re,Re)=>{var j=On(),M=_(j);x(M,()=>ke,(L,E)=>{E(L,{children:(A,oe)=>{me(A,{onclick:()=>{t.transform.translate({x:0,y:-120})},variant:"outline",size:"xsm",class:"hover:bg-secondary-5 bg-neutral-1 hover:text-secondary-12 pointer-events-auto flex items-center justify-center",children:(S,Ce)=>{se(S,{icon:"material-symbols:arrow-back-2",width:"3rem",class:"text-neutral-11 -rotate-90"})},$$slots:{default:!0}})},$$slots:{default:!0}})});var ne=I(M,2);x(ne,()=>Ie,(L,E)=>{E(L,{children:(A,oe)=>{be();var S=pe("Move down");u(A,S)},$$slots:{default:!0}})}),u(re,j)},$$slots:{default:!0}})}),T(nt),T(D);var ot=I(D,2),$e=k(ot);x($e,()=>Te,(ee,te)=>{te(ee,{children:(re,Re)=>{var j=jn(),M=_(j);x(M,()=>ke,(L,E)=>{E(L,{children:(A,oe)=>{me(A,{get onclick(){return t.transform.reset},variant:"outline",size:"xsm",class:"hover:bg-secondary-5 bg-neutral-1 hover:text-secondary-12 pointer-events-auto flex items-center justify-center",children:(S,Ce)=>{se(S,{icon:"material-symbols:home",width:"3rem",class:"text-neutral-11"})},$$slots:{default:!0}})},$$slots:{default:!0}})});var ne=I(M,2);x(ne,()=>Ie,(L,E)=>{E(L,{children:(A,oe)=>{be();var S=pe("Reset layout position");u(A,S)},$$slots:{default:!0}})}),u(re,j)},$$slots:{default:!0}})}),T(ot);var at=I(ot,2),sr=k(at);x(sr,()=>Te,(ee,te)=>{te(ee,{children:(re,Re)=>{var j=Mn(),M=_(j);x(M,()=>ke,(L,E)=>{E(L,{children:(A,oe)=>{const S=H(()=>t.gridManager.config.snapToGrid?"bg-secondary-5 border-secondary-6 hover:bg-neutral-3 hover:border-neutral-8":"bg-neutral-1 hover:bg-secondary-5");me(A,{onclick:()=>{t.gridManager.config.snapToGrid=!t.gridManager.config.snapToGrid},variant:"outline",size:"xsm",get class(){return`${i(S)??""} hover:text-secondary-12 pointer-events-auto flex rotate-180 items-center justify-center transition-colors`},children:(Ce,Tt)=>{se(Ce,{icon:"iconoir:magnet-solid",width:"3rem",class:"text-neutral-11"})},$$slots:{default:!0}})},$$slots:{default:!0}})});var ne=I(M,2);x(ne,()=>Ie,(L,E)=>{E(L,{children:(A,oe)=>{be();var S=pe("Toggle snap to grid");u(A,S)},$$slots:{default:!0}})}),u(re,j)},$$slots:{default:!0}})}),T(at);var Ot=I(at,2),ir=k(Ot);x(ir,()=>Te,(ee,te)=>{te(ee,{children:(re,Re)=>{var j=Fn(),M=_(j);x(M,()=>ke,(L,E)=>{E(L,{children:(A,oe)=>{const S=H(()=>t.gridManager.config.rightAngleConstraint?"bg-secondary-5 border-secondary-6 hover:bg-neutral-3 hover:border-neutral-8":"bg-neutral-1 hover:bg-secondary-5");me(A,{onclick:()=>{t.gridManager.config.rightAngleConstraint=!t.gridManager.config.rightAngleConstraint},variant:"outline",size:"xsm",get class(){return`${i(S)??""} hover:text-secondary-12 pointer-events-auto flex items-center justify-center transition-colors`},children:(Ce,Tt)=>{se(Ce,{icon:"mdi:parallel",width:"3rem",class:"text-neutral-11"})},$$slots:{default:!0}})},$$slots:{default:!0}})});var ne=I(M,2);x(ne,()=>Ie,(L,E)=>{E(L,{children:(A,oe)=>{be();var S=pe("Toggle right angle constraint");u(A,S)},$$slots:{default:!0}})}),u(re,j)},$$slots:{default:!0}})}),T(Ot),T(B),ue(()=>{Le(B,1,`flex ${i(a)??""} ${i(l)??""} gap-2`),Le(D,1,`grid gap-1 ${i(o)==="horizontal"?"grid-cols-3 grid-rows-2":"grid-cols-2 grid-rows-3"}`),Le(z,1,_t(i(o)==="horizontal"?"order-1 row-span-2 self-center":"order-2")),Le(Q,1,_t(i(o)==="horizontal"?"order-2":"order-1 col-span-2 justify-self-center")),Le(_e,1,_t(i(o)==="horizontal"?"order-3 row-span-2 self-center":"order-3")),Le(nt,1,_t(i(o)==="horizontal"?"order-4":"order-4 col-span-2 justify-self-center"))}),u(Z,B)},$$slots:{default:!0}})}),u(y,V)},$$slots:{default:!0}})}),u(C,m)},$$slots:{default:!0}})}),T(f),ue(()=>Le(f,1,`flex h-full w-full p-2 ${i(s)??""}`)),u(r,f),Y()}function Vn(r,e){const t=e.safeParse(r);if(!t.success)return t.error.issues.map(n=>n.message)}function Kn(r){switch(r.type){case"RECTANGLE":{const e=r.rectangleLength/2,t=r.rectangleWidth/2;return[{x:-e,y:t},{x:0,y:t},{x:e,y:t},{x:e,y:0},{x:e,y:-t},{x:0,y:-t},{x:-e,y:-t},{x:-e,y:0}]}case"POLYGON":return[{x:0,y:r.polygonRadius}];case"ELLIPSE":{const e=r.ellipseLength/2,t=r.ellipseWidth/2;return[{x:0,y:t},{x:e,y:0},{x:0,y:-t},{x:-e,y:0}]}case"LINES":return r.linesCoordinates.map(e=>({x:e.x,y:e.y}))}}function Qn(r,e){U(e,!0);const t=2,n=et(e.canvasId);let o=new Pe.Group;e.geometryGroup.add(o),o.moveToTop();let s=[],a=e.geometry.type,l=0;function d(f){const c={};switch(e.geometry.type){case"RECTANGLE":{if(f%2===0){const g=Math.abs(s[f].x())*2,p=Math.abs(s[f].y())*2;c.rectangleLength=De(n.transform.modelDistance(g),t),c.rectangleWidth=De(n.transform.modelDistance(p),t)}else if(f===1||f===5){s[f].x(0);const g=Math.abs(s[f].y())*2;c.rectangleWidth=De(n.transform.modelDistance(g),t)}else{s[f].y(0);const g=Math.abs(s[f].x())*2;c.rectangleLength=De(n.transform.modelDistance(g),t)}break}case"POLYGON":{s[f].x(0);const g=Math.abs(s[f].y());c.polygonRadius=De(n.transform.modelDistance(g),t);break}case"ELLIPSE":{if(f%2===0){s[f].x(0);const g=Math.abs(s[f].y())*2;c.ellipseWidth=De(n.transform.modelDistance(g),t)}else{s[f].y(0);const g=Math.abs(s[f].x())*2;c.ellipseLength=De(n.transform.modelDistance(g),t)}break}case"LINES":{c.linesCoordinates=s.map(g=>({x:De(n.transform.modelXPos(g.x()),t),y:De(n.transform.modelYPos(g.y()),t)}));break}}return c}Se(()=>{const f=Kn(e.geometry);l===0||a!=e.geometry.type||l!=f.length?(s=[],o.destroyChildren(),f.forEach((c,g)=>{const p=new Pe.Circle({radius:6,strokeWidth:3,x:n.transform.canvasXPos(c.x),y:n.transform.canvasYPos(c.y),draggable:!0,stroke:e.strokeColor,fill:e.fillColor});p.on("mouseover",C=>{document.body.style.cursor="grab",C.cancelBubble=!0}),p.on("mouseout",C=>{document.body.style.cursor="default",C.cancelBubble=!0}),p.on("dragmove",C=>{e.onTransform&&e.onTransform(d(g),!1),C.cancelBubble=!0}),p.on("dragend",C=>{e.onTransform&&e.onTransform(d(g),!0),C.cancelBubble=!0}),s.push(p),o.add(p)})):f.forEach((c,g)=>{if(s[g])s[g].x(n.transform.canvasXPos(c.x)),s[g].y(n.transform.canvasYPos(c.y));else throw new yt("Geometry resize points caught in an invalid state.")}),o.moveToTop(),a=e.geometry.type,l=f.length}),Se(()=>{s.forEach(f=>{f.stroke(e.strokeColor),f.fill(e.fillColor)})}),qt(()=>{o.destroy()}),Y()}function qn(r,e,t=!1,n,o){const s={x:r.transform.canvasXPos(0),y:r.transform.canvasYPos(0),strokeScaleEnabled:r.transform.strokeScale,...n};switch(e.type){case"RECTANGLE":return new Pe.Rect({width:r.transform.canvasDistance(e.rectangleLength),height:r.transform.canvasDistance(e.rectangleWidth),offset:{x:r.transform.canvasDistance(e.rectangleLength)/2,y:r.transform.canvasDistance(e.rectangleWidth)/2},...s});case"POLYGON":return new Pe.RegularPolygon({sides:e.polygonNumSides,radius:r.transform.canvasDistance(e.polygonRadius),...s});case"ELLIPSE":return new Pe.Ellipse({radiusX:r.transform.canvasDistance(e.ellipseLength/2),radiusY:r.transform.canvasDistance(e.ellipseWidth/2),...s});case"LINES":return new Pe.Line({points:e.linesCoordinates.reduce((a,l)=>(a.push(r.transform.canvasXPos(l.x),r.transform.canvasYPos(l.y)),a),[]),closed:e.linesClosed||t,...s})}throw new yt("Geometry type undefined.")}function Gn(r,e,t,n){return qn(r,e,!0,t)}function Vt(r,e,t){if(t instanceof Pe.Rect)e.rectangleLength&&(t.width(r.transform.canvasDistance(e.rectangleLength)),t.offsetX(r.transform.canvasDistance(e.rectangleLength)/2)),e.rectangleWidth&&(t.height(r.transform.canvasDistance(e.rectangleWidth)),t.offsetY(r.transform.canvasDistance(e.rectangleWidth)/2));else if(t instanceof Pe.RegularPolygon)e.polygonNumSides&&t.sides(e.polygonNumSides),e.polygonRadius&&t.radius(r.transform.canvasDistance(e.polygonRadius));else if(t instanceof Pe.Ellipse)e.ellipseLength&&t.radiusX(r.transform.canvasDistance(e.ellipseLength/2)),e.ellipseWidth&&t.radiusY(r.transform.canvasDistance(e.ellipseWidth/2));else if(t instanceof Pe.Line)e.linesCoordinates&&t.points(e.linesCoordinates.reduce((n,o)=>(n.push(r.transform.canvasXPos(o.x),r.transform.canvasYPos(o.y)),n),[])),e.linesClosed&&t.closed(e.linesClosed);else throw new yt("Geometry shape of an unsupported type.")}function tr(r,e){U(e,!0);let t=ce(e,"showName",3,!0),n=ce(e,"labelTranslate",19,()=>({x:0,y:0}));const o=10,s=et(e.canvasId),a=s.container.getLayer(e.plantingAreaLayerId),l=new Pe.Group({draggable:e.editable});a.add(l);let d=null,f=new Pe.Text({fontFamily:"sans",fontSize:15,opacity:.7,text:e.name,visible:t()});l.add(f);let c=e.geometry.type,g=H(()=>e.selected?Be("accent",8,s.mode.current):Be("brown",10,s.mode.current)),p=H(()=>e.selected?Be("accent",5,s.mode.current):Be("brown",3,s.mode.current)),C=H(()=>e.selected?3:2),h=H(()=>e.selected?Be("accent",11,s.mode.current):Be("brown",11,s.mode.current));Se(()=>{e.geometry.type!==c||!d?(d==null||d.destroy(),d=Gn(s,e.geometry,{stroke:i(g),fill:i(p),strokeWidth:i(C)}),d&&(l.add(d),l.rotation(e.geometry.rotation),f.y(s.transform.canvasYPos(Ft(e.geometry)+n().y)),f.x(s.transform.canvasXPos(n().x)))):(Vt(s,e.geometry,d),f.y(s.transform.canvasYPos(Ft(e.geometry)+n().y)),f.x(s.transform.canvasXPos(n().x))),c=e.geometry.type}),Se(()=>{e.position?(l.position({x:s.transform.canvasXPos(e.position.x),y:s.transform.canvasYPos(e.position.y)}),l.visible(!0)):l.visible(!1)}),Se(()=>{d==null||d.fill(i(p)),d==null||d.stroke(i(g)),d==null||d.strokeWidth(i(C)),f.fill(i(h))}),Se(()=>{f.text(e.name),f.offsetX(f.width()/2),f.offsetY(f.height()+o)}),Se(()=>{e.editable?(l.draggable(!0),d==null||d.on("mouseover",()=>{document.body.style.cursor="move"}),d==null||d.on("mouseout",()=>{s.selectionGroup.setDocumentCursor()}),l.on("dragmove",()=>{e.onTranslate&&e.onTranslate({x:l.x(),y:l.y()},!1)}),l.on("dragend",()=>{l.position(s.gridManager.snapToGrid(l.position())),e.onTranslate&&e.onTranslate({x:l.x(),y:l.y()},!0)}),l.on("pointerclick",()=>{e.onClick&&e.onClick()})):(l.draggable(!1),l.off("mouseover mouseout dragmove dragend pointerclick"))});function m(y,X){d&&Vt(s,y,d),e.onTransform&&e.onTransform(y,X)}qt(()=>{l.destroy()});var b=N(),w=_(b);{var v=y=>{Qn(y,{get canvasId(){return e.canvasId},get geometry(){return e.geometry},get strokeColor(){return i(g)},get fillColor(){return i(p)},geometryGroup:l,onTransform:m})};$(w,y=>{e.editable&&y(v)})}u(r,b),Y()}function Zn(r,e){U(e,!0),et(e.canvasId).container.addLayer(e.plantingAreaLayerId);var n=N(),o=_(n);ze(o,()=>e.children),u(r,n),Y()}var Jn=R("<!> <!>",1);function eo(r,e){U(e,!0);var t=N(),n=_(t);x(n,()=>Hr,(o,s)=>{s(o,{children:(a,l)=>{var d=Jn(),f=_(d);x(f,()=>Rr,(g,p)=>{p(g,{class:"w-8",children:(C,h)=>{se(C,{get icon(){return Je.formFieldDescriptionIcon},width:"1rem",class:"text-destructive-9 hover:text-destructive-10 ml-2"})},$$slots:{default:!0}})});var c=I(f,2);x(c,()=>Dr,(g,p)=>{p(g,{class:"max-w-2xl",children:(C,h)=>{be();var m=pe();ue(b=>Ne(m,b),[()=>e.errors.join(" ")]),u(C,m)},$$slots:{default:!0}})}),u(a,d)},$$slots:{default:!0}})}),u(r,t),Y()}const $t="/~";function to(r,e){return`${r}${$t}${e}`}function He(r,e){return`${r}${$t}${e}`}function At(r){const e=r.split($t);if(e.length<2||e.length>3)throw new yt(`Invalid Tree ID format: ${r}`);return e[2]?{entityType:e[0],entityId:e[1],field:e[2]}:{entityType:e[0],entityId:e[1]}}function de(r,e,t,n){const o=Vn(e,t);return o?(n[r]=o,!1):!0}var ro=(r,e,t)=>{r.stopPropagation(),!e(r)&&!r.shiftKey&&i(t).tree.clearSelection(),e(r)?i(t).toggleSelect():i(t).tree.select(i(t).id),r.shiftKey&&i(t).tree.selectUntil(i(t).id),i(t).focus()},no=R('<span class="bg-accent-7 h-3 w-3 rounded-[4px]"></span>'),oo=R('<button aria-label="select" class="border-accent-8 mr-1 flex h-5 w-5 items-center justify-center rounded-[4px] border-2"><!></button>'),ao=R('<div class="flex grow items-center"><div class="bg-neutral-3 mx-3 h-[1px] w-full"></div> <!></div>'),so=r=>r.stopPropagation(),io=r=>r.stopPropagation(),lo=R('<div role="none" class="flex w-1/2 items-center"><div class="mr-1 flex items-center"><!></div> <!></div>'),co=R('<ul><div class="bg-neutral-5 absolute bottom-4 top-4 w-[1px]"></div> <!></ul>'),uo=R('<li><div><div class="flex items-center gap-2 pl-2"><!> <!> <span> </span> <!></div>  <!></div> <!></li>'),fo=R("<ul><!></ul>");function go(r,e){U(e,!0);const t=(d,f=Pt,c)=>{let g=Kt(()=>pr(c==null?void 0:c(),0));var p=N(),C=_(p);Rt(C,17,f,h=>h.id,(h,m)=>{var b=uo(),w=D=>{D.stopPropagation(),i(m).tree.expandOnClick&&i(m).canExpand&&(!i(m).tree.multiple||!o(D)&&!D.shiftKey)&&i(m).toggleExpand(),i(m).focus()};let v;var y=k(b),X=k(y),V=k(X);{var ae=D=>{var z=oo();z.__click=[ro,o,m];var ge=k(z);{var Q=J=>{var _e=no();u(J,_e)};$(ge,J=>{i(m).selected&&J(Q)})}T(z),u(D,z)};$(V,D=>{At(i(m).id).field||D(ae)})}var ie=I(V,2);{var ye=D=>{se(D,{get icon(){return i(m).item.icon},width:"1.25rem"})};$(ie,D=>{i(m).item.icon&&D(ye)})}var O=I(ie,2),K=k(O,!0);T(O);var Z=I(O,2);{var F=D=>{_r(D,{get description(){return i(m).item.description}})};$(Z,D=>{i(m).item.description&&D(F)})}T(X);var B=I(X,2);{var G=D=>{var z=ao(),ge=I(k(z),2);const Q=H(()=>i(m).expanded?"rotate-90":""),J=H(()=>i(m).selected?"hover:bg-accent-5":"hover:bg-neutral-3");se(ge,{get icon(){return Je.chevronRight},width:"1rem",get class(){return`${i(Q)??""} ml-2 h-6 w-8 rounded-md p-1  ${i(J)??""}`}}),T(z),u(D,z)},fe=(D,z)=>{{var ge=Q=>{var J=lo();J.__click=[so],J.__keydown=[io];var _e=k(J),It=k(_e);{var nt=$e=>{eo($e,{get errors(){return e.fieldErrors[i(m).id]}})};$(It,$e=>{Object.keys(e.fieldErrors).includes(i(m).id)&&$e(nt)})}T(_e);var kt=I(_e,2);const ot=H(()=>Object.keys(e.fieldErrors).includes(i(m).id));x(kt,()=>i(m).item.valueComponent,($e,at)=>{at($e,{get value(){return i(m).item.value},get editing(){return e.editing},get onChange(){return i(m).item.onChange},get errors(){return i(ot)}})}),T(J),u(Q,J)};$(D,Q=>{i(m).item.valueComponent&&i(m).item.onChange&&Q(ge)},z)}};$(B,D=>{var z;(z=i(m).children)!=null&&z.length?D(G):D(fe,!1)})}T(y);var xe=I(y,2);{var he=D=>{var z=co();let ge;var Q=k(z),J=I(Q,2);t(J,()=>i(m).children,()=>i(g)+1),T(z),ue(()=>{ge=Fe(z,ge,{...e.editableTree.tree.group,class:`${i(m).expanded?"h-auto opacity-100":"pointer-events-none h-0 opacity-0"} relative origin-left`}),Bt(Q,`left: ${.5+i(g)*1}rem`)}),u(D,z)};$(xe,D=>{var z;(z=i(m).children)!=null&&z.length&&!i(m).item.value&&D(he)})}T(b),ue(()=>{v=Fe(b,v,{...i(m).attrs,onclick:w,class:"cursor-pointer py-3"}),Le(y,1,`flex justify-between gap-4 rounded-md py-2 pr-2 ${i(g)==0?"":"pl-2"}`),Bt(y,`margin-left: ${i(g)*1}rem`),Ne(K,i(m).item.label)}),u(h,b)}),u(d,p)};function n(){return/mac/i.test(navigator.platform)}function o(d){return n()?d.metaKey:d.ctrlKey}var s=fo();let a;var l=k(s);return t(l,()=>e.editableTree.tree.children),T(s),ue(()=>a=Fe(s,a,{...e.editableTree.tree.root,class:"px-2"})),u(r,s),Y({isMac:n,isControlOrMeta:o})}en(["click","keydown"]);function rr(r,e){U(e,!0);var t=N(),n=_(t);{var o=a=>{me(a,{class:"flex w-full select-none items-center justify-center",onclick:()=>{e.onChange(void 0)},children:(l,d)=>{se(l,{get icon(){return Je.addIcon},width:"1.5rem",class:"text-neutral-11"})},$$slots:{default:!0}})},s=a=>{me(a,{class:"flex w-full select-none items-center justify-center",disabled:!0,children:(l,d)=>{se(l,{get icon(){return Je.addIcon},width:"1.5rem",class:"text-neutral-11"})},$$slots:{default:!0}})};$(n,a=>{e.editing?a(o):a(s,!1)})}u(r,t),Y()}var mo=R('<div><div class="@xs:flex-row flex w-full grid-cols-3 grid-rows-2 flex-col justify-between"><div class="flex w-full"><span class="bg-neutral-2 border-neutral-7 border-r-neutral-5 @xs:rounded-bl-md @xs:border-b flex h-10 w-8 items-center justify-center rounded-l-md rounded-bl-none border border-b-0 border-r-0 px-3 text-sm">X</span> <span class="@xs:border-b @xs:rounded-tr-none border-neutral-7 bg-neutral-1 flex w-full items-center justify-center rounded-l-none rounded-r-none rounded-tr-md border border-b-0"> </span></div> <div class="flex w-full"><span class="bg-neutral-2 border-neutral-7 @xs:border-x-neutral-5 @xs:border-b @xs:border-l-0 flex h-10 w-8 items-center justify-center rounded-none border border-b-0 border-r-0 px-3 text-sm">Y</span> <span class="@xs:border-b border-neutral-7 bg-neutral-1 flex w-full items-center justify-center rounded-l-none rounded-r-none border border-b-0"> </span></div> <span> </span> <!></div></div>');function vo(r,e){U(e,!0);let t=ce(e,"decimalPlaces",3,2),n=wt(e,["$$slots","$$events","$$legacy","x","y","initialUnitSystem","decimalPlaces"]);const o=Cr("distance",[e.x,e.y],e.initialUnitSystem,t());Se(()=>{o.setDisplayValues([e.x,e.y])});var s=mo();let a;var l=k(s),d=k(l),f=I(k(d),2),c=k(f,!0);T(f),T(d);var g=I(d,2),p=I(k(g),2),C=k(p,!0);T(p),T(g);var h=I(g,2),m=k(h,!0);T(h);var b=I(h,2);x(b,()=>nn,(w,v)=>{v(w,{get onclick(){return o.swapUnits},type:"button",class:"border-x-neutral-7 @xs:border-x-neutral-5 bg-neutral-2 hover:bg-neutral-3 @xs:h-10 @xs:w-8 @xs:rounded-none @xs:rounded-r-md flex h-8 w-full items-center justify-center rounded-b-md border px-2",children:(y,X)=>{se(y,{icon:"material-symbols:swap-horiz-rounded",width:"1rem"})},$$slots:{default:!0}})}),T(l),T(s),ue(()=>{a=Fe(s,a,{...n,class:"@container h-full w-full"}),Ne(c,e.x),Ne(C,e.y),Le(h,1,`border-x-neutral-7 @xs:border-x-neutral-5 bg-neutral-2 border-neutral-7 @xs:h-10 @xs:w-8 @xs:border-b @xs:border-l-0 flex h-8 w-full min-w-10 items-center justify-center border-x border-y border-b-0 px-3 ${o.unitSystem==="metric"?"text-lg":"text-md"} text-neutral-11`),Ne(m,o.unitSymbol)}),u(r,s),Y()}function nr(r,e){U(e,!0);var t=N(),n=_(t);{var o=a=>{Pr(a,{get x(){return e.value.x},get y(){return e.value.y},onValueChange:l=>{e.onChange(l)}})},s=a=>{vo(a,{get x(){return e.value.x},get y(){return e.value.y}})};$(n,a=>{e.editing?a(o):a(s,!1)})}u(r,t),Y()}function ho(r,e){U(e,!0);var t=N(),n=_(t);{var o=a=>{Yt(a,{get value(){return e.value},onValueChange:l=>{l&&e.onChange(l)}})},s=a=>{Yt(a,{get value(){return e.value},disabled:!0})};$(n,a=>{e.editing?a(o):a(s,!1)})}u(r,t),Y()}function or(r,e){U(e,!0);var t=N(),n=_(t);{var o=a=>{me(a,{class:"bg-destructive-6 text-destructive-12 w-full select-none",onclick:()=>{e.onChange(void 0)},children:(l,d)=>{se(l,{get icon(){return Je.deleteIcon},width:"1.5rem",class:"text-neutral-11"})},$$slots:{default:!0}})},s=a=>{me(a,{class:"bg-destructive-6 text-destructive-12 w-full select-none",disabled:!0,children:(l,d)=>{se(l,{get icon(){return Je.deleteIcon},width:"1.5rem",class:"text-neutral-11"})},$$slots:{default:!0}})};$(n,a=>{e.editing?a(o):a(s,!1)})}u(r,t),Y()}var po=R("<span> </span>");function rt(r,e){var t=po(),n=k(t,!0);T(t),ue(()=>{Le(t,1,`${e.value?"":"italic"} border-neutral-7 bg-neutral-1 ring-offset-neutral-1 focus-visible:ring-neutral-7 flex w-full rounded-md border px-3 py-2 text-sm focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-offset-2`),Ne(n,e.value||"None")}),u(r,t)}function Ue(r,e){U(e,!0);var t=N(),n=_(t);{var o=a=>{wr(a,{oninput:l=>{e.onChange(l)},get value(){return e.value},quantityType:"distance"})},s=a=>{rt(a,{get value(){return e.value}})};$(n,a=>{e.editing?a(o):a(s,!1)})}u(r,t),Y()}var bo=R('<div class="item-center flex"><span> </span></div>'),yo=R('<div class="item-center flex"><span> </span></div>'),xo=R("<!> <!>",1);function _o(r,e){U(e,!0);const t=H(()=>e.value.options.find(l=>l.id===e.value.id)??{label:"Make a selection"});var n=N(),o=_(n);{var s=l=>{var d=N(),f=_(d);x(f,()=>dn,(c,g)=>{g(c,{type:"single",get value(){return e.value.id},onValueChange:p=>{e.onChange({id:p,options:e.value.options})},children:(p,C)=>{var h=xo(),m=_(h);x(m,()=>on,(w,v)=>{v(w,{class:"w-full",children:(y,X)=>{var V=bo(),ae=k(V),ie=k(ae,!0);T(ae),T(V),ue(()=>Ne(ie,i(t).label)),u(y,V)},$$slots:{default:!0}})});var b=I(m,2);x(b,()=>an,(w,v)=>{v(w,{children:(y,X)=>{var V=N(),ae=_(V);x(ae,()=>sn,(ie,ye)=>{ye(ie,{children:(O,K)=>{var Z=N(),F=_(Z);Rt(F,17,()=>e.value.options,Qt,(B,G)=>{var fe=N(),xe=_(fe);x(xe,()=>ln,(he,D)=>{D(he,{get value(){return i(G).id},get label(){return i(G).label},children:(z,ge)=>{var Q=yo(),J=k(Q),_e=k(J,!0);T(J),T(Q),ue(()=>Ne(_e,i(G).label)),u(z,Q)},$$slots:{default:!0}})}),u(B,fe)}),u(O,Z)},$$slots:{default:!0}})}),u(y,V)},$$slots:{default:!0}})}),u(p,h)},$$slots:{default:!0}})}),u(l,d)},a=l=>{rt(l,{get value(){return i(t).label}})};$(o,l=>{e.editing?l(s):l(a,!1)})}u(r,n),Y()}function Co(r,e){let t=Me("");var n=N(),o=_(n);{var s=l=>{Ir(l,{get value(){return e.value},get onValueChange(){return e.onChange},get label(){return i(t)},set label(d){ve(t,d,!0)}})},a=l=>{rt(l,{get value(){return i(t)}})};$(o,l=>{e.editing?l(s):l(a,!1)})}u(r,n)}function ar(r){return e=>{const t=e.target;t!=null&&t.value&&r(t.value)}}function Po(r){return e=>{const t=e.target;t!=null&&t.value&&r(Number(t.value))}}function Lt(r,e){U(e,!0);var t=N(),n=_(t);{var o=a=>{const l=H(()=>Po(e.onChange));Jt(a,{get value(){return e.value},type:"number",class:"select-none",get oninput(){return i(l)}})},s=a=>{rt(a,{get value(){return e.value}})};$(n,a=>{e.editing?a(o):a(s,!1)})}u(r,t),Y()}function wo(r,e){U(e,!0);var t=N(),n=_(t);{var o=a=>{const l=H(()=>ar(e.onChange));Jt(a,{get value(){return e.value},class:"select-none",get oninput(){return i(l)}})},s=a=>{rt(a,{get value(){return e.value}})};$(n,a=>{e.editing?a(o):a(s,!1)})}u(r,t),Y()}function Io(r,e){U(e,!0);var t=N(),n=_(t);{var o=a=>{const l=H(()=>ar(e.onChange));tn(a,{get value(){return e.value},class:"select-none",get oninput(){return i(l)}})},s=a=>{rt(a,{get value(){return e.value}})};$(n,a=>{e.editing?a(o):a(s,!1)})}u(r,t),Y()}function ko(r,e,t){let n=new Set;function o(a){const l=a.difference(n),d=n.difference(a);for(const f of l){const{entityType:c,entityId:g}=At(f);e[c].add(g)}for(const f of d){const{entityType:c,entityId:g}=At(f);e[c].remove(g)}n=new Set([...a])}return{tree:new Br({items:r,expandOnClick:!0,multiple:!0,onSelectedChange:o})}}function To(r,e,t,n){const o=r+`${e.index}/`;if(!e.geometry)return{id:o,label:"Failed to resolve geometry."};const s=o+"type",a=o+"scaleFactor",l=o+"rotation";W.geometryDateSchema.description,Zt(e.geometry.date,Et());const d={id:s,label:"Type",description:W.geometryTypeSchema.description,valueComponent:Co,value:e.geometry.type,onChange:h=>{!de(s,h,W.geometryTypeSchema,n.fieldErrors)||!e.geometry||n.updateHandler(e.geometry.id,{type:h})}},f={id:a,label:"Scale Factor",description:W.geometryScaleFactorSchema.description,valueComponent:Lt,value:e.geometry.scaleFactor,onChange:h=>{!de(a,h,W.geometryScaleFactorSchema,n.fieldErrors)||!e.geometry||n.updateHandler(e.geometry.id,{scaleFactor:h})}},c={id:l,label:"Rotation",description:W.geometryRotationSchema.description,valueComponent:Lt,value:e.geometry.rotation,onChange:h=>{!de(l,h,W.geometryRotationSchema,n.fieldErrors)||!e.geometry||n.updateHandler(e.geometry.id,{rotation:h})}};let g=[];switch(e.geometry.type){case"RECTANGLE":{const h=o+"rectangleLength",m=o+"rectangleWidth";g=[{id:h,label:"Length",description:W.geometryRectangleLengthSchema.description,valueComponent:Ue,value:e.geometry.rectangleLength,onChange:b=>{!de(h,b,W.geometryRectangleLengthSchema,n.fieldErrors)||!e.geometry||n.updateHandler(e.geometry.id,{rectangleLength:b})}},{id:m,label:"Width",description:W.geometryRectangleWidthSchema.description,valueComponent:Ue,value:e.geometry.rectangleWidth,onChange:b=>{!de(m,b,W.geometryRectangleWidthSchema,n.fieldErrors)||!e.geometry||n.updateHandler(e.geometry.id,{rectangleWidth:b})}}];break}case"POLYGON":{const h=o+"polygonNumSides",m=o+"polygonRadius";g=[{id:h,label:"Side Count",description:W.geometryPolygonNumSidesSchema.description,valueComponent:Lt,value:e.geometry.polygonNumSides,onChange:b=>{!de(h,b,W.geometryPolygonNumSidesSchema,n.fieldErrors)||!e.geometry||n.updateHandler(e.geometry.id,{polygonNumSides:b})}},{id:m,label:"Radius",description:W.geometryPolygonRadiusSchema.description,valueComponent:Ue,value:e.geometry.polygonRadius,onChange:b=>{!de(m,b,W.geometryPolygonRadiusSchema,n.fieldErrors)||!e.geometry||n.updateHandler(e.geometry.id,{polygonRadius:b})}}];break}case"ELLIPSE":{const h=o+"ellipseLength",m=o+"ellipseWidth";g=[{id:h,label:"Length",description:W.geometryEllipseLengthSchema.description,valueComponent:Ue,value:e.geometry.ellipseLength,onChange:b=>{!de(h,b,W.geometryEllipseLengthSchema,n.fieldErrors)||!e.geometry||n.updateHandler(e.geometry.id,{ellipseLength:b})}},{id:m,label:"Width",description:W.geometryEllipseWidthSchema.description,valueComponent:Ue,value:e.geometry.ellipseWidth,onChange:b=>{!de(m,b,W.geometryEllipseWidthSchema,n.fieldErrors)||!e.geometry||n.updateHandler(e.geometry.id,{ellipseWidth:b})}}];break}case"LINES":{const h=o+"linesCoordinates",m=o+"linesAddCoordinate",b=e.geometry.linesCoordinates.map((v,y)=>{const X=o+`linesCoordinate${y}`,V=X+"/position",ae=X+"/delete",ie={id:V,label:"Position",description:W.coordinateSchema.description,valueComponent:nr,value:v,onChange:O=>{if(!de(V,O,W.coordinateSchema,n.fieldErrors)||!e.geometry)return;const K=e.geometry.linesCoordinates;K[y]=O,n.updateHandler(e.geometry.id,{linesCoordinates:K})}},ye={id:ae,label:"Delete",description:"Deletes the coordinate.",valueComponent:or,value:void 0,onChange:()=>{if(!e.geometry)return;const O=e.geometry.linesCoordinates.filter(K=>K.id!=v.id);n.updateHandler(e.geometry.id,{linesCoordinates:O})}};return{id:X,label:`Coordinate ${y}`,children:[ie,ye]}}),w={id:m,label:"Add Coordinate",valueComponent:rr,value:void 0,onChange:()=>{if(!e.geometry)return;const v=[...e.geometry.linesCoordinates],y={x:v[v.length-1].x+.1,y:v[v.length-1].y+.1};v.push(y),n.updateHandler(e.geometry.id,{linesCoordinates:v})}};W.geometryLinesClosedSchema.description,e.geometry.linesClosed,g=[{id:h,label:"Coordinates",children:[...b,w]}];break}}let p=[];p=[d,f,c,...g];const C=t.includeIndex?`Geometry ${e.index+1}`:"Geometry";return{id:o,label:C,children:p}}function So(r,e,t,n){const o=r+`${e.index}/`;if(!e.location)return{id:o,label:"Failed to resolve location."};const s=o+"date",a=o+"coordinate",l=o+"workspace",d=o+"delete",f={id:s,label:"Date",description:W.locationDateSchema.description,valueComponent:ho,value:Zt(e.location.date,Et()),onChange:h=>{de(s,h,W.locationDateSchema,n.fieldErrors)&&n.updateHandler(e.location.id,{date:h.toDate(Et())})}},c={id:a,label:"Position",description:W.coordinateSchema.description,valueComponent:nr,value:{x:e.location.x,y:e.location.y},onChange:h=>{de(a,h,W.coordinateSchema,n.fieldErrors)&&n.updateHandler(e.location.id,{coordinate:h})}},g={id:l,label:"Workspace",description:"The workspace the location is located in.",valueComponent:_o,value:{id:e.location.workspaceId,options:e.workspaces.map(h=>({id:h.id,label:h.name}))},onChange:h=>{n.updateHandler(e.location.id,{workspaceId:h.id})}},p={id:d,label:"Delete",description:"Deletes the geometry from the history.",valueComponent:or,value:void 0,onChange:()=>{n.updateHandler(e.location.id,{delete:!0})}},C=[f,c,g];return t.includeDelete&&C.push(p),{id:o,label:`Location ${e.index+1}`,children:C}}function Lo(r,e,t){const n=He(r,"locations");if(!e.locationHistory)return{id:n,label:"Failed to resolve locations."};const o=He(r,"locationAdd"),s=e.locationHistory.locations.map((l,d)=>{var g;const f=(g=e.locationHistory)==null?void 0:g.locations.length,c=!!(f&&f>1);return So(n,{location:l,workspaces:e.workspaces,index:d},{includeDelete:c},{updateHandler:t.locationUpdateHandler,fieldErrors:t.fieldErrors})}),a={id:o,label:"Add",description:"Adds a new location to the history.",valueComponent:rr,value:void 0,onChange:()=>{e.locationHistory&&t.onLocationHistoryExtend(e.locationHistory.id)}};return{id:n,label:"Locations",children:[...s,a]}}async function Eo({params:r}){const e=await st.fetchOne(ur.Vars({gardenId:r.gardenId,workspaceSlug:r.workspaceSlug}));if(!e)throw cr(`/gardens/${r.gardenId}/workspaces`),new yt(`Workspace ${r.workspaceSlug} does not exist`);return{workspace:e}}const Pa=Object.freeze(Object.defineProperty({__proto__:null,load:Eo},Symbol.toStringTag,{value:"Module"}));function Ao(r,e){U(e,!0);const[t,n]=xr(),o=()=>yr(l,"$formData",t),s=tt(),a=s.layoutCanvasContext,{form:l}=s.plantingAreaCreateForm.form;function d(c){We(l,le(o).location.coordinate={x:a.transform.modelXPos(c.x),y:a.transform.modelYPos(c.y)},le(o))}function f(c){c.rectangleLength&&We(l,le(o).geometry.rectangleLength=c.rectangleLength,le(o)),c.rectangleWidth&&We(l,le(o).geometry.rectangleWidth=c.rectangleWidth,le(o)),c.polygonNumSides&&We(l,le(o).geometry.polygonNumSides=c.polygonNumSides,le(o)),c.polygonRadius&&We(l,le(o).geometry.polygonRadius=c.polygonRadius,le(o)),c.ellipseLength&&We(l,le(o).geometry.ellipseLength=c.ellipseLength,le(o)),c.ellipseWidth&&We(l,le(o).geometry.ellipseWidth=c.ellipseWidth,le(o)),c.linesCoordinates&&c.linesCoordinates&&We(l,le(o).geometry.linesCoordinates=c.linesCoordinates,le(o))}tr(r,{get canvasId(){return a.canvasId},get plantingAreaLayerId(){return e.plantingAreaLayerId},get name(){return o().name},showName:!0,get position(){return o().location.coordinate},get geometry(){return o().geometry},editable:!0,selected:!0,onTranslate:d,onTransform:f}),Y(),n()}function Ro(r,e){U(e,!0);const t=tt(),n=t.layoutCanvasContext,o=n.canvasId,s=Ct(st,fr.Vars({plantingAreaId:e.plantingAreaId})),a=Ye($r),l=Ye(Gt);let d=H(()=>s.results&&s.results[0]?s.results[0]:null),f=H(()=>{var w;if(i(d)&&i(d).locationHistory){const v=Wr((w=i(d).locationHistory)==null?void 0:w.locations,t.timelineSelection.focusUtc);return v&&v.workspaceId===t.id?{x:v.x,y:v.y}:null}else return null}),c=H(()=>t.editing&&!it.isToolActive("plantingAreaCreate")),g=H(()=>t.selections.has("plantingArea",e.plantingAreaId));function p(w){!i(d)||!t.id||a.execute({id:i(d).locationHistoryId,workspaceId:t.id,coordinate:{x:n.transform.modelXPos(w.x),y:n.transform.modelYPos(w.y)},date:t.timelineSelection.focusUtc})}function C(w){i(d)&&l.execute(i(d).geometryId,w)}var h=N(),m=_(h);{var b=w=>{tr(w,{canvasId:o,get plantingAreaLayerId(){return e.plantingAreaLayerId},get name(){return i(d).name},showName:!0,get position(){return i(f)},get geometry(){return i(d).geometry},get editable(){return i(c)},get selected(){return i(g)},onTranslate:p,onTransform:C,onClick:()=>{it.isToolActive("plantingAreaCreate")||t.selections.select("plantingArea",e.plantingAreaId)}})};$(m,w=>{i(d)&&i(d).geometry&&w(b)})}u(r,h),Y()}var Do=R("<!> <!>",1),Ho=R("<!> <!>",1);function No(r,e){U(e,!0);const t=l=>{Xn(l,{canvasId:s})},s=tt().layoutCanvasContext.canvasId,a="plantingAreas";un(r,{canvasId:s,overlay:t,children:(l,d)=>{var f=Ho(),c=_(f);fn(c,{canvasId:s});var g=I(c,2);Zn(g,{canvasId:s,plantingAreaLayerId:a,children:(p,C)=>{var h=Do(),m=_(h);{var b=v=>{Ao(v,{plantingAreaLayerId:a})};$(m,v=>{it.isToolActive("plantingAreaCreate")&&v(b)})}var w=I(m,2);Rt(w,17,()=>e.plantingAreaIds,Qt,(v,y)=>{Ro(v,{get plantingAreaId(){return i(y)},plantingAreaLayerId:a})}),u(p,h)},$$slots:{default:!0}}),u(l,f)},$$slots:{default:!0}}),Y()}var zo=R('<span class="p-2 italic">No planting areas.</span>');function Wo(r,e){U(e,!0);const t=tt(),n=br({});let o=H(()=>Ct(st,gr.Vars({ids:e.plantingAreaIds}))),s=H(()=>Ct(st,mr.Vars({gardenId:Jr.params.gardenId}))),a=H(()=>{var v;return((v=i(s).results)==null?void 0:v.map(y=>({id:y.id,name:y.name})))||[]});const l=Ye(Or.mutation),d=Ye(Gt),f=Ye(Mr),c=Ye(jr);function g(v){const y=to("plantingArea",v.id),X=He(y,"name"),V=He(y,"description"),ae=He(y,"depth"),ie=To(He(y,"geometry"),{geometry:v.geometry,index:0},{includeIndex:!1},{updateHandler:(F,B)=>{d.execute(F,B)},fieldErrors:n}),ye=Lo(y,{locationHistory:v.locationHistory,workspaces:i(a)},{locationUpdateHandler:(F,B)=>{f.execute(F,B)},onLocationHistoryExtend:F=>{c.execute(F,t.timelineSelection.focusUtc)},fieldErrors:n}),O={id:X,label:"Name",description:W.plantingAreaNameSchema.description,valueComponent:wo,value:v.name,onChange:F=>{de(X,F,W.plantingAreaNameSchema,n)&&l.execute(v.id,{name:F})}},K={id:V,label:"Description",description:W.plantingAreaDescriptionSchema.description,valueComponent:Io,value:v.description,onChange:F=>{de(V,F,W.plantingAreaDescriptionSchema,n)&&l.execute(v.id,{description:F})}},Z={id:ae,label:"Depth",description:W.plantingAreaDepthSchema.description,valueComponent:Ue,value:v.depth,onChange:F=>{de(ae,F,W.plantingAreaDepthSchema,n)&&l.execute(v.id,{depth:F})}};return{id:y,label:v.name,children:[O,{id:He(y,"details"),label:"Details",children:[K,Z]},ie,ye]}}let p=H(()=>(i(o).results||[]).map(v=>g(v)));const C=ko(()=>i(p),{plantingArea:{add:v=>{t.selections.select("plantingArea",v)},remove:v=>{t.selections.deselect("plantingArea",v)}}});t.selections.addSelectionChangeHandler("plantingArea",(v,y)=>{v.forEach(X=>{C.tree.select(He("plantingArea",X))}),y.forEach(X=>{C.tree.deselect(He("plantingArea",X))})});var h=N(),m=_(h);{var b=v=>{var y=zo();u(v,y)},w=v=>{var y=N(),X=_(y);x(X,()=>rn,(V,ae)=>{ae(V,{class:"h-full w-full px-2",children:(ie,ye)=>{go(ie,{editableTree:C,get fieldErrors(){return n},get editing(){return t.editing}})},$$slots:{default:!0}})}),u(v,y)};$(m,v=>{e.plantingAreaIds.length===0?v(b):v(w,!1)})}u(r,h),Y()}var $o=R("<!> <!>",1);function Oo(r,e){var t=N(),n=_(t);x(n,()=>Ur,(o,s)=>{s(o,{value:"plantingAreas",class:"bg-neutral-1 flex h-full flex-col",children:(a,l)=>{var d=$o(),f=_(d);x(f,()=>Yr,(g,p)=>{p(g,{class:"h-8 shadow-none",children:(C,h)=>{var m=N(),b=_(m);x(b,()=>Xr,(w,v)=>{v(w,{value:"plantingAreas",class:"border-neutral-5 text-neutral-11 flex w-full items-center justify-between border-b p-0 px-4 py-1",children:(y,X)=>{be();var V=pe("Planting Areas");u(y,V)},$$slots:{default:!0}})}),u(C,m)},$$slots:{default:!0}})});var c=I(f,2);x(c,()=>Vr,(g,p)=>{p(g,{value:"plantingAreas",class:"mt-0 overflow-hidden",children:(C,h)=>{Wo(C,{get plantingAreaIds(){return e.plantingAreaIds}})},$$slots:{default:!0}})}),u(a,d)},$$slots:{default:!0}})}),u(r,t)}var jo=R("<!> <!>",1),Mo=R("<!> <!>",1),Fo=R("<!> <!> <!>",1),Bo=R('<div class="flex h-full w-full flex-col"><div class="h-full grow overflow-hidden"><!></div> <div class="bottom-0 h-24"><!></div></div>');function Uo(r,e){U(e,!0);const t=tt();let n=Me(!0);Se(()=>{t.contentPaneDirection&&(ve(n,!1),ve(n,!0))});const o=Ct(st,vr.Vars({workspaceId:t.id}));var s=Bo(),a=k(s),l=k(a);{var d=g=>{var p=N(),C=_(p);x(C,()=>qr,(h,m)=>{m(h,{get direction(){return t.contentPaneDirection},children:(b,w)=>{var v=Fo(),y=_(v);{var X=O=>{var K=jo(),Z=_(K);x(Z,()=>St,(B,G)=>{G(B,{defaultSize:70,order:1,minSize:10,children:(fe,xe)=>{var he=N(),D=_(he);Nr(D,()=>t.id,z=>{const ge=H(()=>{var Q;return((Q=o.results)==null?void 0:Q.map(J=>J.id))||[]});No(z,{get plantingAreaIds(){return i(ge)}})}),u(fe,he)},$$slots:{default:!0}})});var F=I(Z,2);x(F,()=>Xt,(B,G)=>{G(B,{withHandle:!1})}),u(O,K)};$(y,O=>{t.layoutEnabled&&O(X)})}var V=I(y,2);{var ae=O=>{var K=Mo(),Z=_(K);x(Z,()=>St,(B,G)=>{G(B,{defaultSize:20,order:2,minSize:10,children:(fe,xe)=>{Qr(fe,{toolbox:it})},$$slots:{default:!0}})});var F=I(Z,2);x(F,()=>Xt,(B,G)=>{G(B,{withHandle:!1})}),u(O,K)};$(V,O=>{it.isActive&&O(ae)})}var ie=I(V,2);{var ye=O=>{var K=N(),Z=_(K);x(Z,()=>St,(F,B)=>{B(F,{defaultSize:30,order:3,minSize:10,children:(G,fe)=>{const xe=H(()=>{var he;return((he=o.results)==null?void 0:he.map(D=>D.id))||[]});Oo(G,{get plantingAreaIds(){return i(xe)}})},$$slots:{default:!0}})}),u(O,K)};$(ie,O=>{t.treeEnabled&&O(ye)})}u(b,v)},$$slots:{default:!0}})}),u(g,p)};$(l,g=>{i(n)&&g(d)})}T(a);var f=I(a,2),c=k(f);Kr(c,{get selection(){return t.timelineSelection}}),T(f),T(s),u(r,s),Y()}function wa(r,e){U(e,!0);const t=tt();Se(()=>{t.id!=e.data.workspace.id&&t.setWorkspace(e.data.workspace.id)});var n=N(),o=_(n);{var s=a=>{Uo(a,{})};$(o,a=>{t.id&&a(s)})}u(r,n),Y()}export{wa as component,Pa as universal};
